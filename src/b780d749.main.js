/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: mark@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * Owner: david@famo.us
 * @license MPL 2.0
 * @copyright Famous Industries, Inc. 2014
 */

/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) lodash.com/license | Underscore.js 1.5.2 underscorejs.org/LICENSE
 * Build: `lodash exports="global"`
 */

!function(){var t,e,n;!function(r){function i(t,e){return b.call(t,e)}function o(t,e){var n,r,i,o,s,a,u,c,l,f,h,p=e&&e.split("/"),d=y.map,m=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=t.split("/"),s=t.length-1,y.nodeIdCompat&&x.test(t[s])&&(t[s]=t[s].replace(x,"")),t=p.concat(t),l=0;l<t.length;l+=1)if(h=t[l],"."===h)t.splice(l,1),l-=1;else if(".."===h){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||m)&&d){for(n=t.split("/"),l=n.length;l>0;l-=1){if(r=n.slice(0,l).join("/"),p)for(f=p.length;f>0;f-=1)if(i=d[p.slice(0,f).join("/")],i&&(i=i[r])){o=i,a=l;break}if(o)break;!u&&m&&m[r]&&(u=m[r],c=l)}!o&&u&&(o=u,a=c),o&&(n.splice(0,a,o),t=n.join("/"))}return t}function s(t,e){return function(){return p.apply(r,w.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return o(e,t)}}function u(t){return function(e){g[t]=e}}function c(t){if(i(v,t)){var e=v[t];delete v[t],_[t]=!0,h.apply(r,e)}if(!i(g,t)&&!i(_,t))throw new Error("No "+t);return g[t]}function l(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function f(t){return function(){return y&&y.config&&y.config[t]||{}}}var h,p,d,m,g={},v={},y={},_={},b=Object.prototype.hasOwnProperty,w=[].slice,x=/\.js$/;d=function(t,e){var n,r=l(t),i=r[0];return t=r[1],i&&(i=o(i,e),n=c(i)),i?t=n&&n.normalize?n.normalize(t,a(e)):o(t,e):(t=o(t,e),r=l(t),i=r[0],t=r[1],i&&(n=c(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:n}},m={require:function(t){return s(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:f(t)}}},h=function(t,e,n,o){var a,l,f,h,p,y,b=[],w=typeof n;if(o=o||t,"undefined"===w||"function"===w){for(e=!e.length&&n.length?["require","exports","module"]:e,p=0;p<e.length;p+=1)if(h=d(e[p],o),l=h.f,"require"===l)b[p]=m.require(t);else if("exports"===l)b[p]=m.exports(t),y=!0;else if("module"===l)a=b[p]=m.module(t);else if(i(g,l)||i(v,l)||i(_,l))b[p]=c(l);else{if(!h.p)throw new Error(t+" missing "+l);h.p.load(h.n,s(o,!0),u(l),{}),b[p]=g[l]}f=n?n.apply(g[t],b):void 0,t&&(a&&a.exports!==r&&a.exports!==g[t]?g[t]=a.exports:f===r&&y||(g[t]=f))}else t&&(g[t]=n)},t=e=p=function(t,e,n,i,o){if("string"==typeof t)return m[t]?m[t](e):c(d(t,e).f);if(!t.splice){if(y=t,y.deps&&p(y.deps,y.callback),!e)return;e.splice?(t=e,e=n,n=null):t=r}return e=e||function(){},"function"==typeof n&&(n=i,i=o),i?h(r,t,e,n):setTimeout(function(){h(r,t,e,n)},4),p},p.config=function(t){return p(t)},t._defined=g,n=function(t,e,n){e.splice||(n=e,e=[]),i(g,t)||i(v,t)||(v[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("famous/core/Entity",["require","exports","module"],function(t,e,n){function r(t){return a[t]}function i(t,e){a[t]=e}function o(t){var e=a.length;return i(e,t),e}function s(t){i(t,null)}var a=[];n.exports={register:o,unregister:s,get:r,set:i}}),n("famous/core/Transform",["require","exports","module"],function(t,e,n){function r(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function i(t){return Math.sqrt(r(t))}function o(t){return 0>t?-1:1}var s={};s.precision=1e-6,s.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s.multiply4x4=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]},s.multiply=function(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},s.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},s.moveThen=function(t,e){t[2]||(t[2]=0);var n=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],r=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],i=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return s.thenMove(e,[n,r,i])},s.translate=function(t,e,n){return void 0===n&&(n=0),[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]},s.thenScale=function(t,e){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],0,e[0]*t[4],e[1]*t[5],e[2]*t[6],0,e[0]*t[8],e[1]*t[9],e[2]*t[10],0,e[0]*t[12],e[1]*t[13],e[2]*t[14],1]},s.scale=function(t,e,n){return void 0===n&&(n=1),[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]},s.rotateX=function(t){var e=Math.cos(t),n=Math.sin(t);return[1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1]},s.rotateY=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1]},s.rotateZ=function(t){var e=Math.cos(t),n=Math.sin(t);return[e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1]},s.rotate=function(t,e,n){var r=Math.cos(t),i=Math.sin(t),o=Math.cos(e),s=Math.sin(e),a=Math.cos(n),u=Math.sin(n),c=[o*a,r*u+i*s*a,i*u-r*s*a,0,-o*u,r*a-i*s*u,i*a+r*s*u,0,s,-i*o,r*o,0,0,0,0,1];return c},s.rotateAxis=function(t,e){var n=Math.sin(e),r=Math.cos(e),i=1-r,o=t[0]*t[0]*i,s=t[0]*t[1]*i,a=t[0]*t[2]*i,u=t[1]*t[1]*i,c=t[1]*t[2]*i,l=t[2]*t[2]*i,f=t[0]*n,h=t[1]*n,p=t[2]*n,d=[o+r,s+p,a-h,0,s-p,u+r,c+f,0,a+h,c-f,l+r,0,0,0,0,1];return d},s.aboutOrigin=function(t,e){var n=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),r=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),i=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return s.thenMove(e,[n,r,i])},s.skew=function(t,e,n){return[1,0,0,0,Math.tan(n),1,0,0,Math.tan(e),Math.tan(t),1,0,0,0,0,1]},s.perspective=function(t){return[1,0,0,0,0,1,0,0,0,0,1,-1/t,0,0,0,1]},s.getTranslate=function(t){return[t[12],t[13],t[14]]},s.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],n=t[4]*t[10]-t[6]*t[8],r=t[4]*t[9]-t[5]*t[8],i=t[1]*t[10]-t[2]*t[9],o=t[0]*t[10]-t[2]*t[8],s=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],u=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],l=t[0]*e-t[1]*n+t[2]*r,f=1/l,h=[f*e,-f*i,f*a,0,-f*n,f*o,-f*u,0,f*r,-f*s,f*c,0,0,0,0,1];return h[12]=-t[12]*h[0]-t[13]*h[4]-t[14]*h[8],h[13]=-t[12]*h[1]-t[13]*h[5]-t[14]*h[9],h[14]=-t[12]*h[2]-t[13]*h[6]-t[14]*h[10],h},s.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},s.interpret=function(t){var e=[t[0],t[1],t[2]],n=o(e[0]),a=i(e),u=[e[0]+n*a,e[1],e[2]],c=2/r(u);if(c>=1/0)return{translate:s.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];l[0]=1-c*u[0]*u[0],l[5]=1-c*u[1]*u[1],l[10]=1-c*u[2]*u[2],l[1]=-c*u[0]*u[1],l[2]=-c*u[0]*u[2],l[6]=-c*u[1]*u[2],l[4]=l[1],l[8]=l[2],l[9]=l[6];var f=s.multiply(l,t),h=[f[5],f[6]],p=o(h[0]),d=i(h),m=[h[0]+p*d,h[1]],g=2/r(m),v=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];v[5]=1-g*m[0]*m[0],v[10]=1-g*m[1]*m[1],v[6]=-g*m[0]*m[1],v[9]=v[6];var y=s.multiply(v,l),_=s.multiply(y,t),b=s.scale(_[0]<0?-1:1,_[5]<0?-1:1,_[10]<0?-1:1);_=s.multiply(_,b),y=s.multiply(b,y);var w={};return w.translate=s.getTranslate(t),w.rotate=[Math.atan2(-y[6],y[10]),Math.asin(y[2]),Math.atan2(-y[1],y[0])],w.rotate[0]||(w.rotate[0]=0,w.rotate[2]=Math.atan2(y[4],y[5])),w.scale=[_[0],_[5],_[10]],w.skew=[Math.atan2(_[9],w.scale[2]),Math.atan2(_[8],w.scale[2]),Math.atan2(_[4],w.scale[0])],Math.abs(w.rotate[0])+Math.abs(w.rotate[2])>1.5*Math.PI&&(w.rotate[1]=Math.PI-w.rotate[1],w.rotate[1]>Math.PI&&(w.rotate[1]-=2*Math.PI),w.rotate[1]<-Math.PI&&(w.rotate[1]+=2*Math.PI),w.rotate[0]<0?w.rotate[0]+=Math.PI:w.rotate[0]-=Math.PI,w.rotate[2]<0?w.rotate[2]+=Math.PI:w.rotate[2]-=Math.PI),w},s.average=function(t,e,n){n=void 0===n?.5:n;for(var r=s.interpret(t),i=s.interpret(e),o={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)o.translate[a]=(1-n)*r.translate[a]+n*i.translate[a],o.rotate[a]=(1-n)*r.rotate[a]+n*i.rotate[a],o.scale[a]=(1-n)*r.scale[a]+n*i.scale[a],o.skew[a]=(1-n)*r.skew[a]+n*i.skew[a];return s.build(o)},s.build=function(t){var e=s.scale(t.scale[0],t.scale[1],t.scale[2]),n=s.skew(t.skew[0],t.skew[1],t.skew[2]),r=s.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return s.thenMove(s.multiply(s.multiply(r,n),e),t.translate)},s.equals=function(t,e){return!s.notEquals(t,e)},s.notEquals=function(t,e){return t===e?!1:t&&e?!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]:!0},s.normalizeRotation=function(t){var e=t.slice(0);for((e[0]===.5*Math.PI||e[0]===.5*-Math.PI)&&(e[0]=-e[0],e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]>.5*Math.PI&&(e[0]=e[0]-Math.PI,e[1]=Math.PI-e[1],e[2]-=Math.PI),e[0]<.5*-Math.PI&&(e[0]=e[0]+Math.PI,e[1]=-Math.PI-e[1],e[2]-=Math.PI);e[1]<-Math.PI;)e[1]+=2*Math.PI;for(;e[1]>=Math.PI;)e[1]-=2*Math.PI;for(;e[2]<-Math.PI;)e[2]+=2*Math.PI;for(;e[2]>=Math.PI;)e[2]-=2*Math.PI;return e},s.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,.001,1],s.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-.001,1],n.exports=s}),n("famous/core/SpecParser",["require","exports","module","./Transform"],function(t,e,n){function r(){this.result={}}function i(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var o=t("./Transform");r._instance=new r,r.parse=function(t,e){return r._instance.parse(t,e)},r.prototype.parse=function(t,e){return this.reset(),this._parseSpec(t,e,o.identity),this.result},r.prototype.reset=function(){this.result={}};var s=[0,0];r.prototype._parseSpec=function(t,e,n){var r,a,u,c,l,f;if("number"==typeof t){if(r=t,u=e.transform,e.size&&e.origin&&(e.origin[0]||e.origin[1])){var h=[e.origin[0]*e.size[0],e.origin[1]*e.size[1],0];u=o.thenMove(u,i(h,n))}this.result[r]={transform:u,opacity:e.opacity,origin:e.origin||s,size:e.size}}else{if(!t)return;if(t instanceof Array)for(var p=0;p<t.length;p++)this._parseSpec(t[p],e,n);else{a=t.target,u=e.transform,c=e.opacity,l=e.origin,f=e.size;var d=n;if(void 0!==t.opacity&&(c=e.opacity*t.opacity),t.transform&&(u=o.multiply(e.transform,t.transform)),t.origin&&(l=t.origin,d=e.transform),t.size){var m=e.size;f=[void 0!==t.size[0]?t.size[0]:m[0],void 0!==t.size[1]?t.size[1]:m[1]],m&&l&&(l[0]||l[1])&&(u=o.thenMove(u,i([l[0]*m[0],l[1]*m[1],0],n)),u=o.moveThen([-l[0]*f[0],-l[1]*f[1],0],u)),d=e.transform,l=null}this._parseSpec(a,{transform:u,opacity:c,origin:l,size:f},d)}}},n.exports=r}),n("famous/core/RenderNode",["require","exports","module","./Entity","./SpecParser"],function(t,e,n){function r(t){this._object=null,this._child=null,this._hasMultipleChildren=!1,this._isRenderable=!1,this._isModifier=!1,this._resultCache={},this._prevResults={},this._childResult=null,t&&this.set(t)}function i(t,e,n){for(var r=s.parse(t,e),a=Object.keys(r),u=0;u<a.length;u++){var c=a[u],l=o.get(c),f=r[c];f.allocator=e.allocator;var h=l.commit(f);h?i(h,e,n):n[c]=f}}var o=t("./Entity"),s=t("./SpecParser");r.prototype.add=function(t){var e=t instanceof r?t:new r(t);return this._child instanceof Array?this._child.push(e):this._child?(this._child=[this._child,e],this._hasMultipleChildren=!0,this._childResult=[]):this._child=e,e},r.prototype.get=function(){return this._object||(this._hasMultipleChildren?null:this._child?this._child.get():null)},r.prototype.set=function(t){return this._childResult=null,this._hasMultipleChildren=!1,this._isRenderable=t.render?!0:!1,this._isModifier=t.modify?!0:!1,this._object=t,this._child=null,t instanceof r?t:this},r.prototype.getSize=function(){var t=null,e=this.get();return e&&e.getSize&&(t=e.getSize()),!t&&this._child&&this._child.getSize&&(t=this._child.getSize()),t},r.prototype.commit=function(t){for(var e=Object.keys(this._prevResults),n=0;n<e.length;n++){var r=e[n];if(void 0===this._resultCache[r]){var s=o.get(r);s.cleanup&&s.cleanup(t.allocator)}}this._prevResults=this._resultCache,this._resultCache={},i(this.render(),t,this._resultCache)},r.prototype.render=function(){if(this._isRenderable)return this._object.render();var t=null;if(this._hasMultipleChildren){t=this._childResult;for(var e=this._child,n=0;n<e.length;n++)t[n]=e[n].render()}else this._child&&(t=this._child.render());return this._isModifier?this._object.modify(t):t},n.exports=r}),n("famous/core/EventEmitter",["require","exports","module"],function(t,e,n){function r(){this.listeners={},this._owner=this}r.prototype.emit=function(t,e){var n=this.listeners[t];if(n)for(var r=0;r<n.length;r++)n[r].call(this._owner,e);return this},r.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var n=this.listeners[t].indexOf(e);return 0>n&&this.listeners[t].push(e),this},r.prototype.addListener=r.prototype.on,r.prototype.removeListener=function(t,e){var n=this.listeners[t].indexOf(e);return n>=0&&this.listeners[t].splice(n,1),this},r.prototype.bindThis=function(t){this._owner=t},n.exports=r}),n("famous/core/EventHandler",["require","exports","module","./EventEmitter"],function(t,e,n){function r(){i.apply(this,arguments),this.downstream=[],this.downstreamFn=[],this.upstream=[],this.upstreamListeners={}}var i=t("./EventEmitter");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),e.subscribe&&e.unsubscribe&&(t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e))},r.setOutputHandler=function(t,e){e instanceof r&&e.bindThis(t),t.pipe=e.pipe.bind(e),t.unpipe=e.unpipe.bind(e),t.on=e.on.bind(e),t.addListener=e.on,t.removeListener=e.removeListener.bind(e)},r.prototype.emit=function(t,e){i.prototype.emit.apply(this,arguments);var n=0;for(n=0;n<this.downstream.length;n++)this.downstream[n].trigger&&this.downstream[n].trigger(t,e);for(n=0;n<this.downstreamFn.length;n++)this.downstreamFn[n](t,e);return this},r.prototype.trigger=r.prototype.emit,r.prototype.pipe=function(t){if(t.subscribe instanceof Function)return t.subscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,n=e.indexOf(t);return 0>n&&e.push(t),t instanceof Function?t("pipe",null):t.trigger&&t.trigger("pipe",null),t},r.prototype.unpipe=function(t){if(t.unsubscribe instanceof Function)return t.unsubscribe(this);var e=t instanceof Function?this.downstreamFn:this.downstream,n=e.indexOf(t);return n>=0?(e.splice(n,1),t instanceof Function?t("unpipe",null):t.trigger&&t.trigger("unpipe",null),t):!1},r.prototype.on=function(t){if(i.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var e=this.trigger.bind(this,t);this.upstreamListeners[t]=e;for(var n=0;n<this.upstream.length;n++)this.upstream[n].on(t,e)}return this},r.prototype.addListener=r.prototype.on,r.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var n in this.upstreamListeners)t.on(n,this.upstreamListeners[n])}return this},r.prototype.unsubscribe=function(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var n in this.upstreamListeners)t.removeListener(n,this.upstreamListeners[n])}return this},n.exports=r}),n("famous/core/ElementAllocator",["require","exports","module"],function(t,e,n){function r(t){t||(t=document.createDocumentFragment()),this.container=t,this.detachedNodes={},this.nodeCount=0}r.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.removeChild(e.firstChild));this.container=t}},r.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,n=this.detachedNodes[t];return n.length>0?e=n.pop():(e=document.createElement(t),this.container.appendChild(e)),this.nodeCount++,e},r.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),n=this.detachedNodes[e];n.push(t),this.nodeCount--},r.prototype.getNodeCount=function(){return this.nodeCount},n.exports=r}),n("famous/utilities/Utility",["require","exports","module"],function(t,e,n){var r={};r.Direction={X:0,Y:1,Z:2},r.after=function(t,e){var n=t;return function(){n--,0===n&&e.apply(this,arguments)}},r.loadURL=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===this.readyState&&e&&e(this.responseText)},n.open("GET",t),n.send()},r.createDocumentFragmentFromHTML=function(t){var e=document.createElement("div");e.innerHTML=t;for(var n=document.createDocumentFragment();e.hasChildNodes();)n.appendChild(e.firstChild);return n},n.exports=r}),n("famous/transitions/MultipleTransition",["require","exports","module","famous/utilities/Utility"],function(t,e,n){function r(t){this.method=t,this._instances=[],this.state=[]}var i=t("famous/utilities/Utility");r.SUPPORTS_MULTIPLE=!0,r.prototype.get=function(){for(var t=0;t<this._instances.length;t++)this.state[t]=this._instances[t].get();return this.state},r.prototype.set=function(t,e,n){for(var r=i.after(t.length,n),o=0;o<t.length;o++)this._instances[o]||(this._instances[o]=new this.method),this._instances[o].set(t[o],e,r)},r.prototype.reset=function(t){for(var e=0;e<t.length;e++)this._instances[e]||(this._instances[e]=new this.method),this._instances[e].reset(t[e])},n.exports=r}),n("famous/transitions/TweenTransition",["require","exports","module"],function(t,e,n){function r(t){this.options=Object.create(r.DEFAULT_OPTIONS),t&&this.setOptions(t),this._startTime=0,this._startValue=0,this._updateTime=0,this._endValue=0,this._curve=void 0,this._duration=0,this._active=!1,this._callback=void 0,this.state=0,this.velocity=void 0}function i(t,e,n){return(1-n)*t+n*e}function o(t){return t instanceof Object?t instanceof Array?t.slice(0):Object.create(t):t}function s(t,e){var n={curve:e.curve};return e.duration&&(n.duration=e.duration),e.speed&&(n.speed=e.speed),t instanceof Object&&(void 0!==t.duration&&(n.duration=t.duration),t.curve&&(n.curve=t.curve),t.speed&&(n.speed=t.speed)),"string"==typeof n.curve&&(n.curve=r.getCurve(n.curve)),n}function a(t,e,n,r,i){var o,s=1e-7,a=(n(i)-n(i-s))/s;if(t instanceof Array){o=[];for(var u=0;u<t.length;u++)o[u]=a*(t[u]-e[u])/r}else o=a*(t-e)/r;return o}function u(t,e,n){var r;if(t instanceof Array){r=[];for(var o=0;o<t.length;o++)r[o]=i(t[o],e[o],n)}else r=i(t,e,n);return r}r.Curves={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},spring:function(t){return(1-t)*Math.sin(6*Math.PI*t)+t}},r.SUPPORTS_MULTIPLE=!0,r.DEFAULT_OPTIONS={curve:r.Curves.linear,duration:500,speed:0};var c={};r.registerCurve=function(t,e){return c[t]?!1:(c[t]=e,!0)},r.unregisterCurve=function(t){return c[t]?(delete c[t],!0):!1},r.getCurve=function(t){return c[t]},r.getCurves=function(){return c},r.prototype.setOptions=function(t){void 0!==t.curve&&(this.options.curve=t.curve),void 0!==t.duration&&(this.options.duration=t.duration),void 0!==t.speed&&(this.options.speed=t.speed)},r.prototype.set=function(t,e,n){if(!e)return this.reset(t),void(n&&n());if(this._startValue=o(this.get()),e=s(e,this.options),e.speed){var r=this._startValue;if(r instanceof Object){var i=0;for(var a in r)i+=(t[a]-r[a])*(t[a]-r[a]);e.duration=Math.sqrt(i)/e.speed}else e.duration=Math.abs(t-r)/e.speed}this._startTime=Date.now(),this._endValue=o(t),this._startVelocity=o(e.velocity),this._duration=e.duration,this._curve=e.curve,this._active=!0,this._callback=n},r.prototype.reset=function(t,e){if(this._callback){var n=this._callback;this._callback=void 0,n()}this.state=o(t),this.velocity=o(e),this._startTime=0,this._duration=0,this._updateTime=0,this._startValue=this.state,this._startVelocity=this.velocity,this._endValue=this.state,this._active=!1},r.prototype.getVelocity=function(){return this.velocity},r.prototype.get=function(t){return this.update(t),this.state},r.prototype.update=function(t){if(this._active){if(t||(t=Date.now()),!(this._updateTime>=t)){this._updateTime=t;var e=t-this._startTime;if(e>=this._duration)this.state=this._endValue,this.velocity=a(this.state,this._startValue,this._curve,this._duration,1),this._active=!1;else if(0>e)this.state=this._startValue,this.velocity=this._startVelocity;else{var n=e/this._duration;this.state=u(this._startValue,this._endValue,this._curve(n)),this.velocity=a(this.state,this._startValue,this._curve,this._duration,n)}}}else if(this._callback){var r=this._callback;this._callback=void 0,r()}},r.prototype.isActive=function(){return this._active},r.prototype.halt=function(){this.reset(this.get())},r.registerCurve("linear",r.Curves.linear),r.registerCurve("easeIn",r.Curves.easeIn),r.registerCurve("easeOut",r.Curves.easeOut),r.registerCurve("easeInOut",r.Curves.easeInOut),r.registerCurve("easeOutBounce",r.Curves.easeOutBounce),r.registerCurve("spring",r.Curves.spring),r.customCurve=function(t,e){return t=t||0,e=e||0,function(n){return t*n+(-2*t-e+3)*n*n+(t+e-2)*n*n*n}},n.exports=r}),n("famous/transitions/Transitionable",["require","exports","module","./MultipleTransition","./TweenTransition"],function(t,e,n){function r(t){this.currentAction=null,this.actionQueue=[],this.callbackQueue=[],this.state=0,this.velocity=void 0,this._callback=void 0,this._engineInstance=null,this._currentMethod=null,this.set(t)}function i(){if(this._callback){var t=this._callback;this._callback=void 0,t()}if(this.actionQueue.length<=0)return void this.set(this.get());this.currentAction=this.actionQueue.shift(),this._callback=this.callbackQueue.shift();var e=null,n=this.currentAction[0],r=this.currentAction[1];r instanceof Object&&r.method?(e=r.method,"string"==typeof e&&(e=a[e])):e=s,this._currentMethod!==e&&(this._engineInstance=!(n instanceof Object)||e.SUPPORTS_MULTIPLE===!0||n.length<=e.SUPPORTS_MULTIPLE?new e:new o(e),this._currentMethod=e),this._engineInstance.reset(this.state,this.velocity),void 0!==this.velocity&&(r.velocity=this.velocity),this._engineInstance.set(n,r,i.bind(this))}var o=t("./MultipleTransition"),s=t("./TweenTransition"),a={};r.registerMethod=function(t,e){return t in a?!1:(a[t]=e,!0)},r.unregisterMethod=function(t){return t in a?(delete a[t],!0):!1},r.prototype.set=function(t,e,n){if(!e)return this.reset(t),n&&n(),this;var r=[t,e];return this.actionQueue.push(r),this.callbackQueue.push(n),this.currentAction||i.call(this),this},r.prototype.reset=function(t,e){this._currentMethod=null,this._engineInstance=null,this.state=t,this.velocity=e,this.currentAction=null,this.actionQueue=[],this.callbackQueue=[]},r.prototype.delay=function(t,e){this.set(this._engineInstance.get(),{duration:t,curve:function(){return 0}},e)},r.prototype.get=function(t){return this._engineInstance&&(this._engineInstance.getVelocity&&(this.velocity=this._engineInstance.getVelocity()),this.state=this._engineInstance.get(t)),this.state},r.prototype.isActive=function(){return!!this.currentAction},r.prototype.halt=function(){this.set(this.get())},n.exports=r}),n("famous/core/Context",["require","exports","module","./RenderNode","./EventHandler","./ElementAllocator","./Transform","famous/transitions/Transitionable"],function(t,e,n){function r(t){return[t.clientWidth,t.clientHeight]}function i(t){this.container=t,this._allocator=new a(t),this._node=new o,this._eventOutput=new s,this._size=r(this.container),this._perspectiveState=new c(0),this._perspective=void 0,this._nodeContext={allocator:this._allocator,transform:u.identity,opacity:1,origin:l,size:this._size},this._eventOutput.on("resize",function(){this.setSize(r(this.container))}.bind(this))}var o=t("./RenderNode"),s=t("./EventHandler"),a=t("./ElementAllocator"),u=t("./Transform"),c=t("famous/transitions/Transitionable"),l=[0,0];i.prototype.getAllocator=function(){return this._allocator},i.prototype.add=function(t){return this._node.add(t)},i.prototype.migrate=function(t){t!==this.container&&(this.container=t,this._allocator.migrate(t))},i.prototype.getSize=function(){return this._size},i.prototype.setSize=function(t){t||(t=r(this.container)),this._size[0]=t[0],this._size[1]=t[1]},i.prototype.update=function(t){t&&(t.transform&&(this._nodeContext.transform=t.transform),t.opacity&&(this._nodeContext.opacity=t.opacity),t.origin&&(this._nodeContext.origin=t.origin),t.size&&(this._nodeContext.size=t.size));var e=this._perspectiveState.get();e!==this._perspective&&(this.container.style.perspective=e?e.toFixed()+"px":"",this.container.style.webkitPerspective=e?e.toFixed():"",this._perspective=e),this._node.commit(this._nodeContext)},i.prototype.getPerspective=function(){return this._perspectiveState.get()},i.prototype.setPerspective=function(t,e,n){return this._perspectiveState.set(t,e,n)},i.prototype.emit=function(t,e){return this._eventOutput.emit(t,e)},i.prototype.on=function(t,e){return this._eventOutput.on(t,e)},i.prototype.removeListener=function(t,e){return this._eventOutput.removeListener(t,e)},i.prototype.pipe=function(t){return this._eventOutput.pipe(t)},i.prototype.unpipe=function(t){return this._eventOutput.unpipe(t)},n.exports=i}),n("famous/core/OptionsManager",["require","exports","module","./EventHandler"],function(t,e,n){function r(t){this._value=t,this.eventOutput=null}function i(){this.eventOutput=new o,this.eventOutput.bindThis(this),o.setOutputHandler(this,this.eventOutput)}var o=t("./EventHandler");r.patch=function(t){for(var e=new r(t),n=1;n<arguments.length;n++)e.patch(arguments[n]);return t},r.prototype.patch=function(){for(var t=this._value,e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)r in t&&n[r]&&n[r].constructor===Object&&t[r]&&t[r].constructor===Object?(t.hasOwnProperty(r)||(t[r]=Object.create(t[r])),this.key(r).patch(n[r]),this.eventOutput&&this.eventOutput.emit("change",{id:r,value:this.key(r).value()})):this.set(r,n[r])}return this},r.prototype.setOptions=r.prototype.patch,r.prototype.key=function(t){var e=new r(this._value[t]);return(!(e._value instanceof Object)||e._value instanceof Array)&&(e._value={}),e},r.prototype.get=function(t){return this._value[t]},r.prototype.getOptions=r.prototype.get,r.prototype.set=function(t,e){var n=this.get(t);return this._value[t]=e,this.eventOutput&&e!==n&&this.eventOutput.emit("change",{id:t,value:e}),this},r.prototype.value=function(){return this._value},r.prototype.on=function(){return i.call(this),this.on.apply(this,arguments)},r.prototype.removeListener=function(){return i.call(this),this.removeListener.apply(this,arguments)},r.prototype.pipe=function(){return i.call(this),this.pipe.apply(this,arguments)},r.prototype.unpipe=function(){return i.call(this),this.unpipe.apply(this,arguments)},n.exports=r}),n("famous/core/Engine",["require","exports","module","./Context","./EventHandler","./OptionsManager"],function(t,e,n){function r(){y.runLoop?(l.step(),requestAnimationFrame(r)):m=!1}function i(){for(var t=0;t<f.length;t++)f[t].emit("resize");v.emit("resize")}var o,s,a=t("./Context"),u=t("./EventHandler"),c=t("./OptionsManager"),l={},f=[],h=[],p=[],d=Date.now(),m=!0,g={},v=new u,y={containerType:"div",containerClass:"famous-container",fpsCap:void 0,runLoop:!0},_=new c(y),b=10;l.step=function(){var t=Date.now();if(!(s&&s>t-d)){var e=0;for(o=t-d,d=t,v.emit("prerender"),e=0;e<h.length;e++)h[e].call(this);for(h.splice(0);p.length&&Date.now()-t<b;)p.shift().call(this);for(e=0;e<f.length;e++)f[e].update();v.emit("postrender")}},requestAnimationFrame(r),window.addEventListener("resize",i,!1),i(),window.addEventListener("touchmove",function(t){t.preventDefault()},!0),l.pipe=function(t){return t.subscribe instanceof Function?t.subscribe(l):v.pipe(t)},l.unpipe=function(t){return t.unsubscribe instanceof Function?t.unsubscribe(l):v.unpipe(t)},l.on=function(t,e){return t in g||(g[t]=v.emit.bind(v,t),document.body.addEventListener(t,g[t])),v.on(t,e)},l.emit=function(t,e){return v.emit(t,e)},l.removeListener=function(t,e){return v.removeListener(t,e)},l.getFPS=function(){return 1e3/o},l.setFPSCap=function(t){s=Math.floor(1e3/t)},l.getOptions=function(){return _.getOptions.apply(_,arguments)},l.setOptions=function(){return _.setOptions.apply(_,arguments)},l.createContext=function(t){if(void 0===t)t=document.createElement(y.containerType),t.classList.add(y.containerClass),document.body.appendChild(t);else if(!(t instanceof Element))throw t=document.createElement(y.containerType),new Error("Tried to create context on non-existent element");var e=new a(t);return l.registerContext(e),e},l.registerContext=function(t){return f.push(t),t},l.nextTick=function(t){h.push(t)},l.defer=function(t){p.push(t)},_.on("change",function(t){"fpsCap"===t.id?l.setFPSCap(t.value):"runLoop"===t.id&&!m&&t.value&&(m=!0,requestAnimationFrame(r))}),n.exports=l}),n("famous/transitions/TransitionableTransform",["require","exports","module","./Transitionable","famous/core/Transform","famous/utilities/Utility"],function(t,e,n){function r(t){this._final=s.identity.slice(),this.translate=new o([0,0,0]),this.rotate=new o([0,0,0]),this.skew=new o([0,0,0]),this.scale=new o([1,1,1]),t&&this.set(t)}function i(){return s.build({translate:this.translate.get(),rotate:this.rotate.get(),skew:this.skew.get(),scale:this.scale.get()})}var o=t("./Transitionable"),s=t("famous/core/Transform"),a=t("famous/utilities/Utility");r.prototype.setTranslate=function(t,e,n){return this.translate.set(t,e,n),this._final=this._final.slice(),this._final[12]=t[0],this._final[13]=t[1],void 0!==t[2]&&(this._final[14]=t[2]),this},r.prototype.setScale=function(t,e,n){return this.scale.set(t,e,n),this._final=this._final.slice(),this._final[0]=t[0],this._final[5]=t[1],void 0!==t[2]&&(this._final[10]=t[2]),this},r.prototype.setRotate=function(t,e,n){return this.rotate.set(t,e,n),this._final=i.call(this),this._final=s.build({translate:this.translate.get(),rotate:t,scale:this.scale.get(),skew:this.skew.get()}),this},r.prototype.setSkew=function(t,e,n){return this.skew.set(t,e,n),this._final=s.build({translate:this.translate.get(),rotate:this.rotate.get(),scale:this.scale.get(),skew:t}),this},r.prototype.set=function(t,e,n){this._final=t;var r=s.interpret(t),i=n?a.after(4,n):null;return this.translate.set(r.translate,e,i),this.rotate.set(r.rotate,e,i),this.skew.set(r.skew,e,i),this.scale.set(r.scale,e,i),this},r.prototype.setDefaultTransition=function(t){this.translate.setDefault(t),this.rotate.setDefault(t),this.skew.setDefault(t),this.scale.setDefault(t)},r.prototype.get=function(){return this.isActive()?i.call(this):this._final},r.prototype.getFinal=function(){return this._final},r.prototype.isActive=function(){return this.translate.isActive()||this.rotate.isActive()||this.scale.isActive()||this.skew.isActive()},r.prototype.halt=function(){this._final=this.get(),this.translate.halt(),this.rotate.halt(),this.skew.halt(),this.scale.halt()},n.exports=r}),n("famous/core/Modifier",["require","exports","module","./Transform","famous/transitions/Transitionable","famous/transitions/TransitionableTransform"],function(t,e,n){function r(t){this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._sizeGetter=null,this._legacyStates={},this._output={transform:o.identity,opacity:1,origin:null,size:null,target:null},t&&(t.transform&&this.transformFrom(t.transform),void 0!==t.opacity&&this.opacityFrom(t.opacity),t.origin&&this.originFrom(t.origin),t.size&&this.sizeFrom(t.size))}function i(){this._transformGetter&&(this._output.transform=this._transformGetter()),this._opacityGetter&&(this._output.opacity=this._opacityGetter()),this._originGetter&&(this._output.origin=this._originGetter()),this._sizeGetter&&(this._output.size=this._sizeGetter())}var o=t("./Transform"),s=t("famous/transitions/Transitionable"),a=t("famous/transitions/TransitionableTransform");r.prototype.transformFrom=function(t){return t instanceof Function?this._transformGetter=t:t instanceof Object&&t.get?this._transformGetter=t.get.bind(t):(this._transformGetter=null,this._output.transform=t),this
},r.prototype.opacityFrom=function(t){return t instanceof Function?this._opacityGetter=t:t instanceof Object&&t.get?this._opacityGetter=t.get.bind(t):(this._opacityGetter=null,this._output.opacity=t),this},r.prototype.originFrom=function(t){return t instanceof Function?this._originGetter=t:t instanceof Object&&t.get?this._originGetter=t.get.bind(t):(this._originGetter=null,this._output.origin=t),this},r.prototype.sizeFrom=function(t){return t instanceof Function?this._sizeGetter=t:t instanceof Object&&t.get?this._sizeGetter=t.get.bind(t):(this._sizeGetter=null,this._output.size=t),this},r.prototype.setTransform=function(t,e,n){return e||this._legacyStates.transform?(this._legacyStates.transform||(this._legacyStates.transform=new a(this._output.transform)),this._transformGetter||this.transformFrom(this._legacyStates.transform),this._legacyStates.transform.set(t,e,n),this):this.transformFrom(t)},r.prototype.setOpacity=function(t,e,n){return e||this._legacyStates.opacity?(this._legacyStates.opacity||(this._legacyStates.opacity=new s(this._output.opacity)),this._opacityGetter||this.opacityFrom(this._legacyStates.opacity),this._legacyStates.opacity.set(t,e,n)):this.opacityFrom(t)},r.prototype.setOrigin=function(t,e,n){return e||this._legacyStates.origin?(this._legacyStates.origin||(this._legacyStates.origin=new s(this._output.origin||[0,0])),this._originGetter||this.originFrom(this._legacyStates.origin),this._legacyStates.origin.set(t,e,n),this):this.originFrom(t)},r.prototype.setSize=function(t,e,n){return t&&(e||this._legacyStates.size)?(this._legacyStates.size||(this._legacyStates.size=new s(this._output.size||[0,0])),this._sizeGetter||this.sizeFrom(this._legacyStates.size),this._legacyStates.size.set(t,e,n),this):this.sizeFrom(t)},r.prototype.halt=function(){this._legacyStates.transform&&this._legacyStates.transform.halt(),this._legacyStates.opacity&&this._legacyStates.opacity.halt(),this._legacyStates.origin&&this._legacyStates.origin.halt(),this._legacyStates.size&&this._legacyStates.size.halt(),this._transformGetter=null,this._opacityGetter=null,this._originGetter=null,this._sizeGetter=null},r.prototype.getTransform=function(){return this._transformGetter()},r.prototype.getFinalTransform=function(){return this._legacyStates.transform?this._legacyStates.transform.getFinal():this._output.transform},r.prototype.getOpacity=function(){return this._opacityGetter()},r.prototype.getOrigin=function(){return this._originGetter()},r.prototype.getSize=function(){return this._sizeGetter?this._sizeGetter():this._output.size},r.prototype.modify=function(t){return i.call(this),this._output.target=t,this._output},n.exports=r}),n("famous/core/Surface",["require","exports","module","./Entity","./EventHandler","./Transform"],function(t,e,n){function r(t){this.options={},this.properties={},this.content="",this.classList=[],this.size=null,this._classesDirty=!0,this._stylesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._dirtyClasses=[],this._matrix=null,this._opacity=1,this._origin=null,this._size=null,this.eventForwarder=function(t){this.emit(t.type,t)}.bind(this),this.eventHandler=new p,this.eventHandler.bindThis(this),this.id=h.register(this),t&&this.setOptions(t),this._currTarget=null}function i(t){for(var e in this.eventHandler.listeners)t.addEventListener(e,this.eventForwarder)}function o(t){for(var e in this.eventHandler.listeners)t.removeEventListener(e,this.eventForwarder)}function s(t){for(var e=0;e<this._dirtyClasses.length;e++)t.classList.remove(this._dirtyClasses[e]);this._dirtyClasses=[]}function a(t){for(var e in this.properties)t.style[e]=this.properties[e]}function u(t){for(var e in this.properties)t.style[e]=""}function c(t){t[12]=Math.round(t[12]*g)/g,t[13]=Math.round(t[13]*g)/g;for(var e="matrix3d(",n=0;15>n;n++)e+=t[n]<1e-6&&t[n]>-1e-6?"0,":t[n]+",";return e+=t[15]+")"}function l(t){return(100*t[0]).toFixed(6)+"% "+(100*t[1]).toFixed(6)+"%"}function f(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}var h=t("./Entity"),p=t("./EventHandler"),d=t("./Transform"),m=void 0!==document.body.style.webkitTransform,g=window.devicePixelRatio||1;r.prototype.elementType="div",r.prototype.elementClass="famous-surface",r.prototype.on=function(t,e){this._currTarget&&this._currTarget.addEventListener(t,this.eventForwarder),this.eventHandler.on(t,e)},r.prototype.removeListener=function(t,e){this.eventHandler.removeListener(t,e)},r.prototype.emit=function(t,e){e&&!e.origin&&(e.origin=this);var n=this.eventHandler.emit(t,e);return n&&e&&e.stopPropagation&&e.stopPropagation(),n},r.prototype.pipe=function(t){return this.eventHandler.pipe(t)},r.prototype.unpipe=function(t){return this.eventHandler.unpipe(t)},r.prototype.render=function(){return this.id},r.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];this._stylesDirty=!0},r.prototype.getProperties=function(){return this.properties},r.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._classesDirty=!0)},r.prototype.removeClass=function(t){var e=this.classList.indexOf(t);e>=0&&(this._dirtyClasses.push(this.classList.splice(e,1)[0]),this._classesDirty=!0)},r.prototype.setClasses=function(t){var e=0,n=[];for(e=0;e<this.classList.length;e++)t.indexOf(this.classList[e])<0&&n.push(this.classList[e]);for(e=0;e<n.length;e++)this.removeClass(n[e]);for(e=0;e<t.length;e++)this.addClass(t[e])},r.prototype.getClassList=function(){return this.classList},r.prototype.setContent=function(t){this.content!==t&&(this.content=t,this._contentDirty=!0)},r.prototype.getContent=function(){return this.content},r.prototype.setOptions=function(t){t.size&&this.setSize(t.size),t.classes&&this.setClasses(t.classes),t.properties&&this.setProperties(t.properties),t.content&&this.setContent(t.content)};var v;v=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?function(t,e){t.style.zIndex=1e6*e[14]|0,t.style.transform=c(e)}:m?function(t,e){t.style.webkitTransform=c(e)}:function(t,e){t.style.transform=c(e)};var y=m?function(t,e){t.style.webkitTransformOrigin=l(e)}:function(t,e){t.style.transformOrigin=l(e)},_=m?function(t){t.style.webkitTransform="scale3d(0.0001,0.0001,1)",t.style.opacity=0}:function(t){t.style.transform="scale3d(0.0001,0.0001,1)",t.style.opacity=0};r.prototype.setup=function(t){var e=t.allocate(this.elementType);if(this.elementClass)if(this.elementClass instanceof Array)for(var n=0;n<this.elementClass.length;n++)e.classList.add(this.elementClass[n]);else e.classList.add(this.elementClass);e.style.display="",i.call(this,e),y(e,[0,0]),this._currTarget=e,this._stylesDirty=!0,this._classesDirty=!0,this._sizeDirty=!0,this._contentDirty=!0,this._matrix=null,this._opacity=void 0,this._origin=null,this._size=null},r.prototype.commit=function(t){this._currTarget||this.setup(t.allocator);var e=this._currTarget,n=t.transform,r=t.opacity,i=t.origin,o=t.size;if(this.size){var u=o;o=[this.size[0],this.size[1]],void 0===o[0]&&u[0]&&(o[0]=u[0]),void 0===o[1]&&u[1]&&(o[1]=u[1])}if(f(this._size,o)&&(this._size=[o[0],o[1]],this._sizeDirty=!0),!n&&this._matrix)return this._matrix=null,this._opacity=0,void _(e);if(this._opacity!==r&&(this._opacity=r,e.style.opacity=r>=1?"0.999999":r),f(this._origin,i)||d.notEquals(this._matrix,n)){n||(n=d.identity),this._matrix=n;var c=n;i&&(this._origin||(this._origin=[0,0]),this._origin[0]=i[0],this._origin[1]=i[1],c=d.moveThen([-this._size[0]*i[0],-this._size[1]*i[1],0],n)),v(e,c)}if(this._classesDirty||this._stylesDirty||this._sizeDirty||this._contentDirty){if(this._classesDirty){s.call(this,e);for(var l=this.getClassList(),h=0;h<l.length;h++)e.classList.add(l[h]);this._classesDirty=!1}this._stylesDirty&&(a.call(this,e),this._stylesDirty=!1),this._sizeDirty&&(this._size&&(e.style.width=this._size[0]!==!0?this._size[0]+"px":"",e.style.height=this._size[1]!==!0?this._size[1]+"px":""),this._sizeDirty=!1),this._contentDirty&&(this.deploy(e),this.eventHandler.emit("deploy"),this._contentDirty=!1)}},r.prototype.cleanup=function(t){var e=0,n=this._currTarget;this.eventHandler.emit("recall"),this.recall(n),n.style.display="none",n.style.width="",n.style.height="",this._size=null,u.call(this,n);var r=this.getClassList();for(s.call(this,n),e=0;e<r.length;e++)n.classList.remove(r[e]);if(this.elementClass)if(this.elementClass instanceof Array)for(e=0;e<this.elementClass.length;e++)n.classList.remove(this.elementClass[e]);else n.classList.remove(this.elementClass);o.call(this,n),this._currTarget=null,t.deallocate(n),_(n)},r.prototype.deploy=function(t){var e=this.getContent();if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},r.prototype.recall=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);this.setContent(e)},r.prototype.getSize=function(t){return t?this._size:this.size||this._size},r.prototype.setSize=function(t){this.size=t?[t[0],t[1]]:null,this._sizeDirty=!0},n.exports=r}),n("famous/surfaces/ImageSurface",["require","exports","module","famous/core/Surface"],function(t,e,n){function r(){this._imageUrl=void 0,i.apply(this,arguments)}var i=t("famous/core/Surface");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.elementType="img",r.prototype.elementClass="famous-surface",r.prototype.setContent=function(t){this._imageUrl=t,this._contentDirty=!0},r.prototype.deploy=function(t){t.src=this._imageUrl||""},r.prototype.recall=function(t){t.src=""},n.exports=r}),n("lodash",["require","exports","module"],function(t,e,n){(function(){function t(t,e,n){n=(n||0)-1;for(var r=t?t.length:0;++n<r;)if(t[n]===e)return n;return-1}function e(e,n){var r=typeof n;if(e=e.l,"boolean"==r||null==n)return e[n]?0:-1;"number"!=r&&"string"!=r&&(r="object");var i="number"==r?n:_+n;return e=(e=e[r])&&e[i],"object"==r?e&&-1<t(e,n)?0:-1:e?0:-1}function n(t){var e=this.l,n=typeof t;if("boolean"==n||null==t)e[t]=!0;else{"number"!=n&&"string"!=n&&(n="object");var r="number"==n?t:_+t,e=e[n]||(e[n]={});"object"==n?(e[r]||(e[r]=[])).push(t):e[r]=!0}}function r(t){return t.charCodeAt(0)}function i(t,e){for(var n=t.m,r=e.m,i=-1,o=n.length;++i<o;){var s=n[i],a=r[i];if(s!==a){if(s>a||"undefined"==typeof s)return 1;if(a>s||"undefined"==typeof a)return-1}}return t.n-e.n}function o(t){var e=-1,r=t.length,i=t[0],o=t[r/2|0],s=t[r-1];if(i&&"object"==typeof i&&o&&"object"==typeof o&&s&&"object"==typeof s)return!1;for(i=u(),i["false"]=i["null"]=i["true"]=i.undefined=!1,o=u(),o.k=t,o.l=i,o.push=n;++e<r;)o.push(t[e]);return o}function s(t){return"\\"+J[t]}function a(){return m.pop()||[]}function u(){return g.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function c(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function l(t){t.length=0,m.length<w&&m.push(t)}function f(t){var e=t.l;e&&f(e),t.k=t.l=t.m=t.object=t.number=t.string=t.o=null,g.length<w&&g.push(t)}function h(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);var r=-1;n=n-e||0;for(var i=Array(0>n?0:n);++r<n;)i[r]=t[e+r];return i}function p(n){function m(t){return t&&"object"==typeof t&&!Hn(t)&&xn.call(t,"__wrapped__")?t:new g(t)}function g(t,e){this.__chain__=!!e,this.__wrapped__=t}function w(t){function e(){if(r){var t=h(r);Sn.apply(t,arguments)}if(this instanceof e){var o=te(n.prototype),t=n.apply(o,t||arguments);return Se(t)?t:o}return n.apply(i,t||arguments)}var n=t[0],r=t[2],i=t[4];return qn(e,t),e}function J(t,e,n,r,i){if(n){var o=n(t);if("undefined"!=typeof o)return o}if(!Se(t))return t;var s=mn.call(t);if(!$[s]||!Nn.nodeClass&&c(t))return t;var u=Rn[s];switch(s){case G:case N:return new u(+t);case B:case V:return new u(t);case U:return o=u(t.source,z.exec(t)),o.lastIndex=t.lastIndex,o}if(s=Hn(t),e){var f=!r;r||(r=a()),i||(i=a());for(var p=r.length;p--;)if(r[p]==t)return i[p];o=s?u(t.length):{}}else o=s?h(t):Yn({},t);return s&&(xn.call(t,"index")&&(o.index=t.index),xn.call(t,"input")&&(o.input=t.input)),e?(r.push(t),i.push(o),(s?Jn:nr)(t,function(t,s){o[s]=J(t,e,n,r,i)}),f&&(l(r),l(i)),o):o}function te(t){return Se(t)?Mn(t):{}}function ne(t,e,n){if("function"!=typeof t)return Qe;if("undefined"==typeof e||!("prototype"in t))return t;var r=t.__bindData__;if("undefined"==typeof r&&(Nn.funcNames&&(r=!t.name),r=r||!Nn.funcDecomp,!r)){var i=bn.call(t);Nn.funcNames||(r=!M.test(i)),r||(r=L.test(i),qn(t,r))}if(!1===r||!0!==r&&1&r[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return Ve(t,e)}function re(t){function e(){var t=u?s:this;if(i){var d=h(i);Sn.apply(d,arguments)}return(o||l)&&(d||(d=h(arguments)),o&&Sn.apply(d,o),l&&d.length<a)?(r|=16,re([n,f?r:-4&r,d,null,s,a])):(d||(d=arguments),c&&(n=t[p]),this instanceof e?(t=te(n.prototype),d=n.apply(t,d),Se(d)?d:t):n.apply(t,d))}var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=1&r,c=2&r,l=4&r,f=8&r,p=n;return qn(e,t),e}function ie(n,r){var i=-1,s=de(),a=n?n.length:0,u=a>=b&&s===t,c=[];if(u){var l=o(r);l?(s=e,r=l):u=!1}for(;++i<a;)l=n[i],0>s(r,l)&&c.push(l);return u&&f(r),c}function oe(t,e,n,r){r=(r||0)-1;for(var i=t?t.length:0,o=[];++r<i;){var s=t[r];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Hn(s)||ye(s))){e||(s=oe(s,e,n));var a=-1,u=s.length,c=o.length;for(o.length+=u;++a<u;)o[c++]=s[a]}else n||o.push(s)}return o}function se(t,e,n,r,i,o){if(n){var s=n(t,e);if("undefined"!=typeof s)return!!s}if(t===e)return 0!==t||1/t==1/e;if(t===t&&!(t&&K[typeof t]||e&&K[typeof e]))return!1;if(null==t||null==e)return t===e;var u=mn.call(t),f=mn.call(e);if(u==D&&(u=W),f==D&&(f=W),u!=f)return!1;switch(u){case G:case N:return+t==+e;case B:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case U:case V:return t==un(e)}if(f=u==R,!f){var h=xn.call(t,"__wrapped__"),p=xn.call(e,"__wrapped__");if(h||p)return se(h?t.__wrapped__:t,p?e.__wrapped__:e,n,r,i,o);if(u!=W||!Nn.nodeClass&&(c(t)||c(e)))return!1;if(u=!Nn.argsObject&&ye(t)?sn:t.constructor,h=!Nn.argsObject&&ye(e)?sn:e.constructor,u!=h&&!(xe(u)&&u instanceof u&&xe(h)&&h instanceof h)&&"constructor"in t&&"constructor"in e)return!1}for(u=!i,i||(i=a()),o||(o=a()),h=i.length;h--;)if(i[h]==t)return o[h]==e;var d=0,s=!0;if(i.push(t),o.push(e),f){if(h=t.length,d=e.length,(s=d==h)||r)for(;d--;)if(f=h,p=e[d],r)for(;f--&&!(s=se(t[f],p,n,r,i,o)););else if(!(s=se(t[d],p,n,r,i,o)))break}else er(e,function(e,a,u){return xn.call(u,a)?(d++,s=xn.call(t,a)&&se(t[a],e,n,r,i,o)):void 0}),s&&!r&&er(t,function(t,e,n){return xn.call(n,e)?s=-1<--d:void 0});return i.pop(),o.pop(),u&&(l(i),l(o)),s}function ae(t,e,n,r,i){(Hn(e)?je:nr)(e,function(e,o){var s,a,u=e,c=t[o];if(e&&((a=Hn(e))||rr(e))){for(u=r.length;u--;)if(s=r[u]==e){c=i[u];break}if(!s){var l;n&&(u=n(c,e),l="undefined"!=typeof u)&&(c=u),l||(c=a?Hn(c)?c:[]:rr(c)?c:{}),r.push(e),i.push(c),l||ae(c,e,n,r,i)}}else n&&(u=n(c,e),"undefined"==typeof u&&(u=e)),"undefined"!=typeof u&&(c=u);t[o]=c})}function ue(t,e){return t+_n(Dn()*(e-t+1))}function ce(n,r,i){var s=-1,u=de(),c=n?n.length:0,h=[],p=!r&&c>=b&&u===t,d=i||p?a():h;for(p&&(d=o(d),u=e);++s<c;){var m=n[s],g=i?i(m,s,n):m;(r?!s||d[d.length-1]!==g:0>u(d,g))&&((i||p)&&d.push(g),h.push(m))}return p?(l(d.k),f(d)):i&&l(d),h}function le(t){return function(e,n,r){var i={};if(n=m.createCallback(n,r,3),Hn(e)){r=-1;for(var o=e.length;++r<o;){var s=e[r];t(i,s,n(s,r,e),e)}}else Jn(e,function(e,r,o){t(i,e,n(e,r,o),o)});return i}}function fe(t,e,n,r,i,o){var s=1&e,a=4&e,u=16&e,c=32&e;if(!(2&e||xe(t)))throw new cn;u&&!n.length&&(e&=-17,u=n=!1),c&&!r.length&&(e&=-33,c=r=!1);var l=t&&t.__bindData__;return l&&!0!==l?(l=h(l),l[2]&&(l[2]=h(l[2])),l[3]&&(l[3]=h(l[3])),!s||1&l[1]||(l[4]=i),!s&&1&l[1]&&(e|=8),!a||4&l[1]||(l[5]=o),u&&Sn.apply(l[2]||(l[2]=[]),n),c&&kn.apply(l[3]||(l[3]=[]),r),l[1]|=e,fe.apply(null,l)):(1==e||17===e?w:re)([t,e,n,r,i,o])}function he(){X.h=P,X.b=X.c=X.g=X.i="",X.e="t",X.j=!0;for(var t,e=0;t=arguments[e];e++)for(var n in t)X[n]=t[n];e=X.a,X.d=/^[^,]+/.exec(e)[0],t=nn,e="return function("+e+"){",n=X;var r="var n,t="+n.d+",E="+n.e+";if(!t)return E;"+n.i+";";n.b?(r+="var u=t.length;n=-1;if("+n.b+"){",Nn.unindexedChars&&(r+="if(s(t)){t=t.split('')}"),r+="while(++n<u){"+n.g+";}}else{"):Nn.nonEnumArgs&&(r+="var u=t.length;n=-1;if(u&&p(t)){while(++n<u){n+='';"+n.g+";}}else{"),Nn.enumPrototypes&&(r+="var G=typeof t=='function';"),Nn.enumErrorProps&&(r+="var F=t===k||t instanceof Error;");var i=[];if(Nn.enumPrototypes&&i.push('!(G&&n=="prototype")'),Nn.enumErrorProps&&i.push('!(F&&(n=="message"||n=="name"))'),n.j&&n.f)r+="var C=-1,D=B[typeof t]&&v(t),u=D?D.length:0;while(++C<u){n=D[C];",i.length&&(r+="if("+i.join("&&")+"){"),r+=n.g+";",i.length&&(r+="}"),r+="}";else if(r+="for(n in t){",n.j&&i.push("m.call(t, n)"),i.length&&(r+="if("+i.join("&&")+"){"),r+=n.g+";",i.length&&(r+="}"),r+="}",Nn.nonEnumShadows){for(r+="if(t!==A){var i=t.constructor,r=t===(i&&i.prototype),f=t===J?I:t===k?j:L.call(t),x=y[f];",k=0;7>k;k++)r+="n='"+n.h[k]+"';if((!(r&&x[n])&&m.call(t,n))",n.j||(r+="||(!x[n]&&t[n]!==A[n])"),r+="){"+n.g+"}";r+="}"}return(n.b||Nn.nonEnumArgs)&&(r+="}"),r+=n.c+";return E",t("d,j,k,m,o,p,q,s,v,A,B,y,I,J,L",e+r+"}")(ne,q,fn,xn,y,ye,Hn,Te,X.f,hn,K,Gn,V,pn,mn)}function pe(t){return Qn[t]}function de(){var e=(e=m.indexOf)===Ne?t:e;return e}function me(t){return"function"==typeof t&&gn.test(t)}function ge(t){var e,n;return!t||mn.call(t)!=W||(e=t.constructor,xe(e)&&!(e instanceof e))||!Nn.argsClass&&ye(t)||!Nn.nodeClass&&c(t)?!1:Nn.ownLast?(er(t,function(t,e,r){return n=xn.call(r,e),!1}),!1!==n):(er(t,function(t,e){n=e}),"undefined"==typeof n||xn.call(t,n))}function ve(t){return Zn[t]}function ye(t){return t&&"object"==typeof t&&"number"==typeof t.length&&mn.call(t)==D||!1}function _e(t,e,n){var r=Wn(t),i=r.length;for(e=ne(e,n,3);i--&&(n=r[i],!1!==e(t[n],n,t)););return t}function be(t){var e=[];return er(t,function(t,n){xe(t)&&e.push(n)}),e.sort()}function we(t){for(var e=-1,n=Wn(t),r=n.length,i={};++e<r;){var o=n[e];i[t[o]]=o}return i}function xe(t){return"function"==typeof t}function Se(t){return!(!t||!K[typeof t])}function Ce(t){return"number"==typeof t||t&&"object"==typeof t&&mn.call(t)==B||!1}function Te(t){return"string"==typeof t||t&&"object"==typeof t&&mn.call(t)==V||!1}function Oe(t){for(var e=-1,n=Wn(t),r=n.length,i=Ye(r);++e<r;)i[e]=t[n[e]];return i}function ke(t,e,n){var r=-1,i=de(),o=t?t.length:0,s=!1;return n=(0>n?An(0,o+n):n)||0,Hn(t)?s=-1<i(t,e,n):"number"==typeof o?s=-1<(Te(t)?t.indexOf(e,n):i(t,e,n)):Jn(t,function(t){return++r<n?void 0:!(s=t===e)}),s}function ze(t,e,n){var r=!0;if(e=m.createCallback(e,n,3),Hn(t)){n=-1;for(var i=t.length;++n<i&&(r=!!e(t[n],n,t)););}else Jn(t,function(t,n,i){return r=!!e(t,n,i)});return r}function Me(t,e,n){var r=[];if(e=m.createCallback(e,n,3),Hn(t)){n=-1;for(var i=t.length;++n<i;){var o=t[n];e(o,n,t)&&r.push(o)}}else Jn(t,function(t,n,i){e(t,n,i)&&r.push(t)});return r}function Ee(t,e,n){if(e=m.createCallback(e,n,3),!Hn(t)){var r;return Jn(t,function(t,n,i){return e(t,n,i)?(r=t,!1):void 0}),r}n=-1;for(var i=t.length;++n<i;){var o=t[n];if(e(o,n,t))return o}}function je(t,e,n){if(e&&"undefined"==typeof n&&Hn(t)){n=-1;for(var r=t.length;++n<r&&!1!==e(t[n],n,t););}else Jn(t,e,n);return t}function Ie(t,e,n){var r=t,i=t?t.length:0;if(e=e&&"undefined"==typeof n?e:ne(e,n,3),Hn(t))for(;i--&&!1!==e(t[i],i,t););else{if("number"!=typeof i)var o=Wn(t),i=o.length;else Nn.unindexedChars&&Te(t)&&(r=t.split(""));Jn(t,function(t,n,s){return n=o?o[--i]:--i,e(r[n],n,s)})}return t}function Le(t,e,n){var r=-1,i=t?t.length:0,o=Ye("number"==typeof i?i:0);if(e=m.createCallback(e,n,3),Hn(t))for(;++r<i;)o[r]=e(t[r],r,t);else Jn(t,function(t,n,i){o[++r]=e(t,n,i)});return o}function Ae(t,e,n){var i=-1/0,o=i;if("function"!=typeof e&&n&&n[e]===t&&(e=null),null==e&&Hn(t)){n=-1;for(var s=t.length;++n<s;){var a=t[n];a>o&&(o=a)}}else e=null==e&&Te(t)?r:m.createCallback(e,n,3),Jn(t,function(t,n,r){n=e(t,n,r),n>i&&(i=n,o=t)});return o}function Fe(t,e,n,r){var i=3>arguments.length;if(e=m.createCallback(e,r,4),Hn(t)){var o=-1,s=t.length;for(i&&(n=t[++o]);++o<s;)n=e(n,t[o],o,t)}else Jn(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)});return n}function Pe(t,e,n,r){var i=3>arguments.length;return e=m.createCallback(e,r,4),Ie(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)}),n}function De(t){var e=-1,n=t?t.length:0,r=Ye("number"==typeof n?n:0);return je(t,function(t){var n=ue(0,++e);r[e]=r[n],r[n]=t}),r}function Re(t,e,n){var r;if(e=m.createCallback(e,n,3),Hn(t)){n=-1;for(var i=t.length;++n<i&&!(r=e(t[n],n,t)););}else Jn(t,function(t,n,i){return!(r=e(t,n,i))});return!!r}function Ge(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=m.createCallback(e,n,3);++o<i&&e(t[o],o,t);)r++}else if(r=e,null==r||n)return t?t[0]:d;return h(t,0,Fn(An(0,r),i))}function Ne(e,n,r){if("number"==typeof r){var i=e?e.length:0;r=0>r?An(0,i+r):r||0}else if(r)return r=He(e,n),e[r]===n?r:-1;return t(e,n,r)}function qe(t,e,n){if("number"!=typeof e&&null!=e){var r=0,i=-1,o=t?t.length:0;for(e=m.createCallback(e,n,3);++i<o&&e(t[i],i,t);)r++}else r=null==e||n?1:An(0,e);return h(t,r)}function He(t,e,n,r){var i=0,o=t?t.length:i;for(n=n?m.createCallback(n,r,1):Qe,e=n(e);o>i;)r=i+o>>>1,n(t[r])<e?i=r+1:o=r;return i}function Be(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n="function"!=typeof e&&r&&r[e]===t?null:e,e=!1),null!=n&&(n=m.createCallback(n,r,3)),ce(t,e,n)}function We(){for(var t=1<arguments.length?arguments:arguments[0],e=-1,n=t?Ae(ar(t,"length")):0,r=Ye(0>n?0:n);++e<n;)r[e]=ar(t,e);return r}function Ue(t,e){var n=-1,r=t?t.length:0,i={};for(e||!r||Hn(t[0])||(e=[]);++n<r;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}function Ve(t,e){return 2<arguments.length?fe(t,17,h(arguments,2),null,e):fe(t,1,null,null,e)}function $e(t,e,n){var r,i,o,s,a,u,c,l=0,f=!1,h=!0;if(!xe(t))throw new cn;if(e=An(0,e)||0,!0===n)var p=!0,h=!1;else Se(n)&&(p=n.leading,f="maxWait"in n&&(An(e,n.maxWait)||0),h="trailing"in n?n.trailing:h);var m=function(){var n=e-(ur()-s);n>0?u=Tn(m,n):(i&&yn(i),n=c,i=u=c=d,n&&(l=ur(),o=t.apply(a,r),u||i||(r=a=null)))},g=function(){u&&yn(u),i=u=c=d,(h||f!==e)&&(l=ur(),o=t.apply(a,r),u||i||(r=a=null))};return function(){if(r=arguments,s=ur(),a=this,c=h&&(u||!p),!1===f)var n=p&&!u;else{i||p||(l=s);var d=f-(s-l),v=0>=d;v?(i&&(i=yn(i)),l=s,o=t.apply(a,r)):i||(i=Tn(g,d))}return v&&u?u=yn(u):u||e===f||(u=Tn(m,e)),n&&(v=!0,o=t.apply(a,r)),!v||u||i||(r=a=null),o}}function Qe(t){return t}function Ze(t,e,n){var r=!0,i=e&&be(e);e&&(n||i.length)||(null==n&&(n=e),o=g,e=t,t=m,i=be(e)),!1===n?r=!1:Se(n)&&"chain"in n&&(r=n.chain);var o=t,s=xe(o);je(i,function(n){var i=t[n]=e[n];s&&(o.prototype[n]=function(){var e=this.__chain__,n=this.__wrapped__,s=[n];if(Sn.apply(s,arguments),s=i.apply(t,s),r||e){if(n===s&&Se(s))return this;s=new o(s),s.__chain__=e}return s})})}function Xe(){}function Ke(t){return function(e){return e[t]}}function Je(){return this.__wrapped__}n=n?ee.defaults(Y.Object(),n,ee.pick(Y,F)):Y;var Ye=n.Array,tn=n.Boolean,en=n.Date,nn=n.Function,rn=n.Math,on=n.Number,sn=n.Object,an=n.RegExp,un=n.String,cn=n.TypeError,ln=[],fn=n.Error.prototype,hn=sn.prototype,pn=un.prototype,dn=n._,mn=hn.toString,gn=an("^"+un(mn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),vn=rn.ceil,yn=n.clearTimeout,_n=rn.floor,bn=nn.prototype.toString,wn=me(wn=sn.getPrototypeOf)&&wn,xn=hn.hasOwnProperty,Sn=ln.push,Cn=hn.propertyIsEnumerable,Tn=n.setTimeout,On=ln.splice,kn=ln.unshift,zn=function(){try{var t={},e=me(e=sn.defineProperty)&&e,n=e(t,t,t)&&e}catch(r){}return n}(),Mn=me(Mn=sn.create)&&Mn,En=me(En=Ye.isArray)&&En,jn=n.isFinite,In=n.isNaN,Ln=me(Ln=sn.keys)&&Ln,An=rn.max,Fn=rn.min,Pn=n.parseInt,Dn=rn.random,Rn={};Rn[R]=Ye,Rn[G]=tn,Rn[N]=en,Rn[H]=nn,Rn[W]=sn,Rn[B]=on,Rn[U]=an,Rn[V]=un;var Gn={};Gn[R]=Gn[N]=Gn[B]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},Gn[G]=Gn[V]={constructor:!0,toString:!0,valueOf:!0},Gn[q]=Gn[H]=Gn[U]={constructor:!0,toString:!0},Gn[W]={constructor:!0},function(){for(var t=P.length;t--;){var e,n=P[t];for(e in Gn)xn.call(Gn,e)&&!xn.call(Gn[e],n)&&(Gn[e][n]=!1)}}(),g.prototype=m.prototype;var Nn=m.support={};!function(){var t=function(){this.x=1},e={0:1,length:1},r=[];t.prototype={valueOf:1,y:1};for(var i in new t)r.push(i);for(i in arguments);Nn.argsClass=mn.call(arguments)==D,Nn.argsObject=arguments.constructor==sn&&!(arguments instanceof Ye),Nn.enumErrorProps=Cn.call(fn,"message")||Cn.call(fn,"name"),Nn.enumPrototypes=Cn.call(t,"prototype"),Nn.funcDecomp=!me(n.WinRTError)&&L.test(p),Nn.funcNames="string"==typeof nn.name,Nn.nonEnumArgs=0!=i,Nn.nonEnumShadows=!/valueOf/.test(r),Nn.ownLast="x"!=r[0],Nn.spliceObjects=(ln.splice.call(e,0,1),!e[0]),Nn.unindexedChars="xx"!="x"[0]+sn("x")[0];try{Nn.nodeClass=!(mn.call(document)==W&&!({toString:0}+""))}catch(o){Nn.nodeClass=!0}}(1),m.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:E,variable:"",imports:{_:m}},Mn||(te=function(){function t(){}return function(e){if(Se(e)){t.prototype=e;var r=new t;t.prototype=null}return r||n.Object()}}());var qn=zn?function(t,e){Z.value=e,zn(t,"__bindData__",Z)}:Xe;Nn.argsClass||(ye=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&xn.call(t,"callee")&&!Cn.call(t,"callee")||!1});var Hn=En||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&mn.call(t)==R||!1},Bn=he({a:"z",e:"[]",i:"if(!(B[typeof z]))return E",g:"E.push(n)"}),Wn=Ln?function(t){return Se(t)?Nn.enumPrototypes&&"function"==typeof t||Nn.nonEnumArgs&&t.length&&ye(t)?Bn(t):Ln(t):[]}:Bn,Un={a:"g,e,K",i:"e=e&&typeof K=='undefined'?e:d(e,K,3)",b:"typeof u=='number'",v:Wn,g:"if(e(t[n],n,g)===false)return E"},Vn={a:"z,H,l",i:"var a=arguments,b=0,c=typeof l=='number'?2:a.length;while(++b<c){t=a[b];if(t&&B[typeof t]){",v:Wn,g:"if(typeof E[n]=='undefined')E[n]=t[n]",c:"}}"},$n={i:"if(!B[typeof t])return E;"+Un.i,b:!1},Qn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zn=we(Qn),Xn=an("("+Wn(Zn).join("|")+")","g"),Kn=an("["+Wn(Qn).join("")+"]","g"),Jn=he(Un),Yn=he(Vn,{i:Vn.i.replace(";",";if(c>3&&typeof a[c-2]=='function'){var e=d(a[--c-1],a[c--],2)}else if(c>2&&typeof a[c-1]=='function'){e=a[--c]}"),g:"E[n]=e?e(E[n],t[n]):t[n]"}),tr=he(Vn),er=he(Un,$n,{j:!1}),nr=he(Un,$n);xe(/x/)&&(xe=function(t){return"function"==typeof t&&mn.call(t)==H});var rr=wn?function(t){if(!t||mn.call(t)!=W||!Nn.argsClass&&ye(t))return!1;var e=t.valueOf,n=me(e)&&(n=wn(e))&&wn(n);return n?t==n||wn(t)==n:ge(t)}:ge,ir=le(function(t,e,n){xn.call(t,n)?t[n]++:t[n]=1}),or=le(function(t,e,n){(xn.call(t,n)?t[n]:t[n]=[]).push(e)}),sr=le(function(t,e,n){t[n]=e}),ar=Le,ur=me(ur=en.now)&&ur||function(){return(new en).getTime()},cr=8==Pn(x+"08")?Pn:function(t,e){return Pn(Te(t)?t.replace(j,""):t,e||0)};return m.after=function(t,e){if(!xe(e))throw new cn;return function(){return 1>--t?e.apply(this,arguments):void 0}},m.assign=Yn,m.at=function(t){var e=arguments,n=-1,r=oe(e,!0,!1,1),e=e[2]&&e[2][e[1]]===t?1:r.length,i=Ye(e);for(Nn.unindexedChars&&Te(t)&&(t=t.split(""));++n<e;)i[n]=t[r[n]];return i},m.bind=Ve,m.bindAll=function(t){for(var e=1<arguments.length?oe(arguments,!0,!1,1):be(t),n=-1,r=e.length;++n<r;){var i=e[n];t[i]=fe(t[i],1,null,null,t)}return t},m.bindKey=function(t,e){return 2<arguments.length?fe(e,19,h(arguments,2),null,t):fe(e,3,null,null,t)},m.chain=function(t){return t=new g(t),t.__chain__=!0,t},m.compact=function(t){for(var e=-1,n=t?t.length:0,r=[];++e<n;){var i=t[e];i&&r.push(i)}return r},m.compose=function(){for(var t=arguments,e=t.length;e--;)if(!xe(t[e]))throw new cn;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}},m.constant=function(t){return function(){return t}},m.countBy=ir,m.create=function(t,e){var n=te(t);return e?Yn(n,e):n},m.createCallback=function(t,e,n){var r=typeof t;if(null==t||"function"==r)return ne(t,e,n);if("object"!=r)return Ke(t);var i=Wn(t),o=i[0],s=t[o];return 1!=i.length||s!==s||Se(s)?function(e){for(var n=i.length,r=!1;n--&&(r=se(e[i[n]],t[i[n]],null,!0)););return r}:function(t){return t=t[o],s===t&&(0!==s||1/s==1/t)}},m.curry=function(t,e){return e="number"==typeof e?e:+e||t.length,fe(t,4,null,null,null,e)},m.debounce=$e,m.defaults=tr,m.defer=function(t){if(!xe(t))throw new cn;var e=h(arguments,1);return Tn(function(){t.apply(d,e)},1)},m.delay=function(t,e){if(!xe(t))throw new cn;var n=h(arguments,2);return Tn(function(){t.apply(d,n)},e)},m.difference=function(t){return ie(t,oe(arguments,!0,!0,1))},m.filter=Me,m.flatten=function(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n="function"!=typeof e&&r&&r[e]===t?null:e,e=!1),null!=n&&(t=Le(t,n,r)),oe(t,e)},m.forEach=je,m.forEachRight=Ie,m.forIn=er,m.forInRight=function(t,e,n){var r=[];er(t,function(t,e){r.push(e,t)});var i=r.length;for(e=ne(e,n,3);i--&&!1!==e(r[i--],r[i],t););return t},m.forOwn=nr,m.forOwnRight=_e,m.functions=be,m.groupBy=or,m.indexBy=sr,m.initial=function(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=i;for(e=m.createCallback(e,n,3);o--&&e(t[o],o,t);)r++}else r=null==e||n?1:e||r;return h(t,0,Fn(An(0,i-r),i))},m.intersection=function(){for(var n=[],r=-1,i=arguments.length,s=a(),u=de(),c=u===t,h=a();++r<i;){var p=arguments[r];(Hn(p)||ye(p))&&(n.push(p),s.push(c&&p.length>=b&&o(r?n[r]:h)))}var c=n[0],d=-1,m=c?c.length:0,g=[];t:for(;++d<m;){var v=s[0],p=c[d];if(0>(v?e(v,p):u(h,p))){for(r=i,(v||h).push(p);--r;)if(v=s[r],0>(v?e(v,p):u(n[r],p)))continue t;g.push(p)}}for(;i--;)(v=s[i])&&f(v);return l(s),l(h),g},m.invert=we,m.invoke=function(t,e){var n=h(arguments,2),r=-1,i="function"==typeof e,o=t?t.length:0,s=Ye("number"==typeof o?o:0);return je(t,function(t){s[++r]=(i?e:t[e]).apply(t,n)}),s},m.keys=Wn,m.map=Le,m.mapValues=function(t,e,n){var r={};return e=m.createCallback(e,n,3),nr(t,function(t,n,i){r[n]=e(t,n,i)}),r},m.max=Ae,m.memoize=function(t,e){if(!xe(t))throw new cn;var n=function(){var r=n.cache,i=e?e.apply(this,arguments):_+arguments[0];return xn.call(r,i)?r[i]:r[i]=t.apply(this,arguments)};return n.cache={},n},m.merge=function(t){var e=arguments,n=2;if(!Se(t))return t;if("number"!=typeof e[2]&&(n=e.length),n>3&&"function"==typeof e[n-2])var r=ne(e[--n-1],e[n--],2);else n>2&&"function"==typeof e[n-1]&&(r=e[--n]);for(var e=h(arguments,1,n),i=-1,o=a(),s=a();++i<n;)ae(t,e[i],r,o,s);return l(o),l(s),t},m.min=function(t,e,n){var i=1/0,o=i;if("function"!=typeof e&&n&&n[e]===t&&(e=null),null==e&&Hn(t)){n=-1;for(var s=t.length;++n<s;){var a=t[n];o>a&&(o=a)}}else e=null==e&&Te(t)?r:m.createCallback(e,n,3),Jn(t,function(t,n,r){n=e(t,n,r),i>n&&(i=n,o=t)});return o},m.omit=function(t,e,n){var r={};if("function"!=typeof e){var i=[];er(t,function(t,e){i.push(e)});for(var i=ie(i,oe(arguments,!0,!1,1)),o=-1,s=i.length;++o<s;){var a=i[o];r[a]=t[a]}}else e=m.createCallback(e,n,3),er(t,function(t,n,i){e(t,n,i)||(r[n]=t)});return r},m.once=function(t){var e,n;if(!xe(t))throw new cn;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}},m.pairs=function(t){for(var e=-1,n=Wn(t),r=n.length,i=Ye(r);++e<r;){var o=n[e];i[e]=[o,t[o]]}return i},m.partial=function(t){return fe(t,16,h(arguments,1))},m.partialRight=function(t){return fe(t,32,null,h(arguments,1))},m.pick=function(t,e,n){var r={};if("function"!=typeof e)for(var i=-1,o=oe(arguments,!0,!1,1),s=Se(t)?o.length:0;++i<s;){var a=o[i];a in t&&(r[a]=t[a])}else e=m.createCallback(e,n,3),er(t,function(t,n,i){e(t,n,i)&&(r[n]=t)});return r},m.pluck=ar,m.property=Ke,m.pull=function(t){for(var e=arguments,n=0,r=e.length,i=t?t.length:0;++n<r;)for(var o=-1,s=e[n];++o<i;)t[o]===s&&(On.call(t,o--,1),i--);return t},m.range=function(t,e,n){t=+t||0,n="number"==typeof n?n:+n||1,null==e&&(e=t,t=0);var r=-1;e=An(0,vn((e-t)/(n||1)));for(var i=Ye(e);++r<e;)i[r]=t,t+=n;return i},m.reject=function(t,e,n){return e=m.createCallback(e,n,3),Me(t,function(t,n,r){return!e(t,n,r)})},m.remove=function(t,e,n){var r=-1,i=t?t.length:0,o=[];for(e=m.createCallback(e,n,3);++r<i;)n=t[r],e(n,r,t)&&(o.push(n),On.call(t,r--,1),i--);
return o},m.rest=qe,m.shuffle=De,m.sortBy=function(t,e,n){var r=-1,o=Hn(e),s=t?t.length:0,c=Ye("number"==typeof s?s:0);for(o||(e=m.createCallback(e,n,3)),je(t,function(t,n,i){var s=c[++r]=u();o?s.m=Le(e,function(e){return t[e]}):(s.m=a())[0]=e(t,n,i),s.n=r,s.o=t}),s=c.length,c.sort(i);s--;)t=c[s],c[s]=t.o,o||l(t.m),f(t);return c},m.tap=function(t,e){return e(t),t},m.throttle=function(t,e,n){var r=!0,i=!0;if(!xe(t))throw new cn;return!1===n?r=!1:Se(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),Q.leading=r,Q.maxWait=e,Q.trailing=i,$e(t,e,Q)},m.times=function(t,e,n){t=-1<(t=+t)?t:0;var r=-1,i=Ye(t);for(e=ne(e,n,1);++r<t;)i[r]=e(r);return i},m.toArray=function(t){return t&&"number"==typeof t.length?Nn.unindexedChars&&Te(t)?t.split(""):h(t):Oe(t)},m.transform=function(t,e,n,r){var i=Hn(t);if(null==n)if(i)n=[];else{var o=t&&t.constructor;n=te(o&&o.prototype)}return e&&(e=m.createCallback(e,r,4),(i?Jn:nr)(t,function(t,r,i){return e(n,t,r,i)})),n},m.union=function(){return ce(oe(arguments,!0,!0))},m.uniq=Be,m.values=Oe,m.where=Me,m.without=function(t){return ie(t,h(arguments,1))},m.wrap=function(t,e){return fe(e,16,[t])},m.xor=function(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(Hn(n)||ye(n))var r=r?ce(ie(r,n).concat(ie(n,r))):n}return r||[]},m.zip=We,m.zipObject=Ue,m.collect=Le,m.drop=qe,m.each=je,m.eachRight=Ie,m.extend=Yn,m.methods=be,m.object=Ue,m.select=Me,m.tail=qe,m.unique=Be,m.unzip=We,Ze(m),m.clone=function(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n=e,e=!1),J(t,e,"function"==typeof n&&ne(n,r,1))},m.cloneDeep=function(t,e,n){return J(t,!0,"function"==typeof e&&ne(e,n,1))},m.contains=ke,m.escape=function(t){return null==t?"":un(t).replace(Kn,pe)},m.every=ze,m.find=Ee,m.findIndex=function(t,e,n){var r=-1,i=t?t.length:0;for(e=m.createCallback(e,n,3);++r<i;)if(e(t[r],r,t))return r;return-1},m.findKey=function(t,e,n){var r;return e=m.createCallback(e,n,3),nr(t,function(t,n,i){return e(t,n,i)?(r=n,!1):void 0}),r},m.findLast=function(t,e,n){var r;return e=m.createCallback(e,n,3),Ie(t,function(t,n,i){return e(t,n,i)?(r=t,!1):void 0}),r},m.findLastIndex=function(t,e,n){var r=t?t.length:0;for(e=m.createCallback(e,n,3);r--;)if(e(t[r],r,t))return r;return-1},m.findLastKey=function(t,e,n){var r;return e=m.createCallback(e,n,3),_e(t,function(t,n,i){return e(t,n,i)?(r=n,!1):void 0}),r},m.has=function(t,e){return t?xn.call(t,e):!1},m.identity=Qe,m.indexOf=Ne,m.isArguments=ye,m.isArray=Hn,m.isBoolean=function(t){return!0===t||!1===t||t&&"object"==typeof t&&mn.call(t)==G||!1},m.isDate=function(t){return t&&"object"==typeof t&&mn.call(t)==N||!1},m.isElement=function(t){return t&&1===t.nodeType||!1},m.isEmpty=function(t){var e=!0;if(!t)return e;var n=mn.call(t),r=t.length;return n==R||n==V||(Nn.argsClass?n==D:ye(t))||n==W&&"number"==typeof r&&xe(t.splice)?!r:(nr(t,function(){return e=!1}),e)},m.isEqual=function(t,e,n,r){return se(t,e,"function"==typeof n&&ne(n,r,2))},m.isFinite=function(t){return jn(t)&&!In(parseFloat(t))},m.isFunction=xe,m.isNaN=function(t){return Ce(t)&&t!=+t},m.isNull=function(t){return null===t},m.isNumber=Ce,m.isObject=Se,m.isPlainObject=rr,m.isRegExp=function(t){return t&&K[typeof t]&&mn.call(t)==U||!1},m.isString=Te,m.isUndefined=function(t){return"undefined"==typeof t},m.lastIndexOf=function(t,e,n){var r=t?t.length:0;for("number"==typeof n&&(r=(0>n?An(0,r+n):Fn(n,r-1))+1);r--;)if(t[r]===e)return r;return-1},m.mixin=Ze,m.noConflict=function(){return n._=dn,this},m.noop=Xe,m.now=ur,m.parseInt=cr,m.random=function(t,e,n){var r=null==t,i=null==e;return null==n&&("boolean"==typeof t&&i?(n=t,t=1):i||"boolean"!=typeof e||(n=e,i=!0)),r&&i&&(e=1),t=+t||0,i?(e=t,t=0):e=+e||0,n||t%1||e%1?(n=Dn(),Fn(t+n*(e-t+parseFloat("1e-"+((n+"").length-1))),e)):ue(t,e)},m.reduce=Fe,m.reduceRight=Pe,m.result=function(t,e){if(t){var n=t[e];return xe(n)?t[e]():n}},m.runInContext=p,m.size=function(t){var e=t?t.length:0;return"number"==typeof e?e:Wn(t).length},m.some=Re,m.sortedIndex=He,m.template=function(t,e,n){var r=m.templateSettings;t=un(t||""),n=tr({},n,r);var i,o=tr({},n.imports,r.imports),r=Wn(o),o=Oe(o),a=0,u=n.interpolate||I,c="__p+='",u=an((n.escape||I).source+"|"+u.source+"|"+(u===E?O:I).source+"|"+(n.evaluate||I).source+"|$","g");t.replace(u,function(e,n,r,o,u,l){return r||(r=o),c+=t.slice(a,l).replace(A,s),n&&(c+="'+__e("+n+")+'"),u&&(i=!0,c+="';"+u+";\n__p+='"),r&&(c+="'+((__t=("+r+"))==null?'':__t)+'"),a=l+e.length,e}),c+="';",u=n=n.variable,u||(n="obj",c="with("+n+"){"+c+"}"),c=(i?c.replace(S,""):c).replace(C,"$1").replace(T,"$1;"),c="function("+n+"){"+(u?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(i?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+c+"return __p}";try{var l=nn(r,"return "+c).apply(d,o)}catch(f){throw f.source=c,f}return e?l(e):(l.source=c,l)},m.unescape=function(t){return null==t?"":un(t).replace(Xn,ve)},m.uniqueId=function(t){var e=++v;return un(null==t?"":t)+e},m.all=ze,m.any=Re,m.detect=Ee,m.findWhere=Ee,m.foldl=Fe,m.foldr=Pe,m.include=ke,m.inject=Fe,Ze(function(){var t={};return nr(m,function(e,n){m.prototype[n]||(t[n]=e)}),t}(),!1),m.first=Ge,m.last=function(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=i;for(e=m.createCallback(e,n,3);o--&&e(t[o],o,t);)r++}else if(r=e,null==r||n)return t?t[i-1]:d;return h(t,An(0,i-r))},m.sample=function(t,e,n){return t&&"number"!=typeof t.length?t=Oe(t):Nn.unindexedChars&&Te(t)&&(t=t.split("")),null==e||n?t?t[ue(0,t.length-1)]:d:(t=De(t),t.length=Fn(An(0,e),t.length),t)},m.take=Ge,m.head=Ge,nr(m,function(t,e){var n="sample"!==e;m.prototype[e]||(m.prototype[e]=function(e,r){var i=this.__chain__,o=t(this.__wrapped__,e,r);return i||null!=e&&(!r||n&&"function"==typeof e)?new g(o,i):o})}),m.VERSION="2.4.1",m.prototype.chain=function(){return this.__chain__=!0,this},m.prototype.toString=function(){return un(this.__wrapped__)},m.prototype.value=Je,m.prototype.valueOf=Je,Jn(["join","pop","shift"],function(t){var e=ln[t];m.prototype[t]=function(){var t=this.__chain__,n=e.apply(this.__wrapped__,arguments);return t?new g(n,t):n}}),Jn(["push","reverse","sort","unshift"],function(t){var e=ln[t];m.prototype[t]=function(){return e.apply(this.__wrapped__,arguments),this}}),Jn(["concat","slice","splice"],function(t){var e=ln[t];m.prototype[t]=function(){return new g(e.apply(this.__wrapped__,arguments),this.__chain__)}}),Nn.spliceObjects||Jn(["pop","shift","splice"],function(t){var e=ln[t],n="splice"==t;m.prototype[t]=function(){var t=this.__chain__,r=this.__wrapped__,i=e.apply(r,arguments);return 0===r.length&&delete r[0],t||n?new g(i,t):i}}),m}var d,m=[],g=[],v=0,y={},_=+new Date+"",b=75,w=40,x=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",S=/\b__p\+='';/g,C=/\b(__p\+=)''\+/g,T=/(__e\(.*?\)|\b__t\))\+'';/g,O=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,z=/\w*$/,M=/^\s*function[ \n\r\t]+\w/,E=/<%=([\s\S]+?)%>/g,j=RegExp("^["+x+"]*0+(?=.$)"),I=/($^)/,L=/\bthis\b/,A=/['\n\r\t\u2028\u2029\\]/g,F="Array Boolean Date Error Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),D="[object Arguments]",R="[object Array]",G="[object Boolean]",N="[object Date]",q="[object Error]",H="[object Function]",B="[object Number]",W="[object Object]",U="[object RegExp]",V="[object String]",$={};$[H]=!1,$[D]=$[R]=$[G]=$[N]=$[B]=$[W]=$[U]=$[V]=!0;var Q={leading:!1,maxWait:0,trailing:!1},Z={configurable:!1,enumerable:!1,value:null,writable:!1},X={a:"",b:null,c:"",d:"",e:"",v:null,g:"",h:null,support:null,i:"",j:!1},K={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},J={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},Y=K[typeof window]&&window||this,te=K[typeof global]&&global;!te||te.global!==te&&te.window!==te||(Y=te);var ee=p();Y._=ee}).call(this),n.exports=_}),function(t,r){if("object"==typeof exports)module.exports=r(e("lodash"),e,exports,module);else if("function"==typeof n&&n.amd)n("fools",["require","exports","module","./lodash"],function(t,e,n){n.exports=r(t("./lodash"),t)});else{var i=function(e){return t[e]},o=t,s={exports:o};t.Fools=r(t._,i,o,s)}}(this,function(t,e){function n(){var e=function(n){try{var r=e.filter?e.filter(n):n;if(r<e.brackets[0]){if(e.min)return"function"==typeof e.min?e.min(r,n):e.min;var i=new Error("below minimum bracket");throw i.data=n,i.value=r,i}if(r>=e.brackets[e.brackets.length-1]&&e.max)return"function"==typeof e.max?e.max(r,n):r;for(var o=0;o<e.brackets.length;++o){var s=e.brackets[o],a=e.brackets[o+1];if(a>r&&r>=s){var u=t.last(t.compact(e.outcomes.slice(0,o+1)));return"function"==typeof u?u(r,n,s,a):u}}if(e.max)return"function"==typeof this.max?this.max(r,n):this.max;var c=new Error("No brackedted result found");throw c.value=r,c.input=n,c}catch(l){if(e.if_error)return e.if_error(l);throw l}};e.outcomes=[],e.brackets=[],e.add=function(t,n){return e.brackets.push(t),e.outcomes.push(n),e},e.add_min=function(t){return e.min=t,e},e.add_max=function(t){return e.max=t,e},e.add_filter=function(t){return e.filter=t,e},h.util.add.err(e),h.util.add.run(e);for(var n=0;n<arguments.length;++n)e.add(arguments[n]);return e}function r(){var t=function(e){for(var n=[],r=[],i=0;i<t.tests.length;++i)try{r.push(t.tests[i](e))}catch(o){r.push([null,o]),n.push(o)}try{t.last_fn&&r.push(t.last_fn(e))}catch(o){n.push(o)}if(n.length){var s=new Error("error in all");if(s.data=n,!t.if_error)throw s;t.if_error(s)}return r};t.tests=[];for(var e=0;e<arguments.length;++e)t.add(arguments[e]);return h.util.add.run(t),h.util.add.err(t),h.util.add.last(t),h.util.add.add(t),t}function i(){function e(e,n,r){t.isFunction(e)?this._get=e:this.name=e,this._rating=n||t.identity,this._weight=r||1}function n(e){return t.isArray(e)?t.map(e,function(t){return{rating:n.rate(t),data:t}}):n.rate(e)}return e.prototype={rate:function(e){var r=this.base(e),i=this.get_rating()(r,e,n),o=this.get_weight();if(!t.isNumber(i))throw new Error("not a number rating");if(!t.isNumber(o))throw new Error("not a number weight");return i*o},base:function(t){return this._get?this._get(t,n):t[this.name]},weight:function(t){return this._weight=t,this},rating:function(t){return this._rating=t,this},get_weight:function(){return this._weight},get_rating:function(){return this._rating}},n.properties=[],n._candidates=[],n.scale=function(){return t.reduce(n.properties,function(t,e){return t+e.get_weight()},0)},n.rate=function(e){var r=0;return t.each(n.properties,function(t){r+=t.rate(e)}),r/n.scale()},n.best=function(){return t.last(t.sortBy(n._candidates,"rating"))},n.worst=function(){return t.first(t.sortBy(n._candidates,"rating"))},n.select=function(e,r,i){return t.filter(n._candidates,function(t){return t.rating>=e&&(i?t.rating<=r:t.rating<r)})},n.add=function(e){if(t.isArray(e)){var r=t.map(e,function(t){return{rating:n.add(t),data:t}});return r}var i=n.rate(e);return n._candidates.push({rating:i,data:e}),i},n.prop=function(t,r,i){var o=new e(t,r,i);return n.properties.push(o),n},n.property=function(t,r,i){var o=new e(t,r,i);return n.properties.push(o),o},n}function o(n){function r(t,n){if("string"!=typeof t)throw new Error(e("util").format("non string dim passed to min: %s,",e("util").inspect(t)));return"function"==typeof s.dims[t].min?s.dims[t].min(n):s.dims[t].min}function i(t,e){return"function"==typeof s.dims[t].max?s.dims[t].max(e):s.dims[t].max}function o(t,e){return"function"==typeof s.dims[t].inc?s.dims[t].inc(e):s.dims[t].inc}var s=function(e){var n=[],a=t.toArray(arguments);a.length<2?n=t.keys(s.dims):t.each(a.slice(1),function(t){s.dims.hasOwnProperty(t)&&n.push(t)});var u={};t.each(n,function(t){u[t]=r(t)});for(var c=!1;!c;){e=s.iterator(u,e,s);for(var l=0,f=!1;!f&&l<n.length;){var h=n[l],p=o(h);u[h]+p<=i(h,u)?(u[h]+=p,f=!0):(u[h]=r(h,u),++l)}c=!f}return e};return s.place=h.fork(function(t,e){return r(t,e)==e[t]}).then("first").else(h.fork(function(t,e){return i(t,e)==e[t]}).then("last").else("middle")),s.dims={},s.iterator=n,s.dim=function(t,e,n,r){return s.dims[t]||(s.dims[t]={min:e||0,max:n||0,inc:r||1}),s._last_dim=t,s},s.max=function(t,e){return e?s._last_dim=e:e=s._last_dim,s.dim(e).dims[e].max=t,s},s.min=function(t,e){return e?s._last_dim=e:e=s._last_dim,s.dim(e).dims[e].min=t,s},s.inc=function(t,e){e?s._last_dim=e:e=_last_dim.last_dim},s}function s(e,n){e||(e=function(t,e){return t===e});var r=function(r,i){r=r.slice(0),i=i.slice(0);var o=[];if(!t.isArray(r)||!t.isArray(i))throw"comparators must be arrays;";return r.length&&i.length?(t.each(r,function(r){for(var s=[],a=!1,u=[],c=0;c<i.length&&!a;++c){var l=i[c];e(r,l)&&(u.push(c),s.push(l),n||(a=!0))}u.reverse();for(var f=0;f<u.length;++f)i.splice(u[f],1);s.length&&o.push(n?[r,s]:[r,t.first(s)])}),o):[]};return r}function a(){var t=function(e){for(var n=[],r=!0,i=0;r&&!n.length&&i<t.tests.length;++i)try{t.tests[i](e)||(r=!1)}catch(o){n.push(o)}try{r&&!n.length&&t.last_fn&&(t.last_fn(e)||(r=!1))}catch(o){n.push(o)}if(n.length){var s=new Error("error in each");if(s.data=n,!t.if_error)throw s;t.if_error(s)}return r};t.tests=[];for(var e=0;e<arguments.length;++e)t.add(arguments[e]);return h.util.add.run(t),h.util.add.err(t),h.util.add.last(t),h.util.add.add(t),t}function u(){var e=function(){for(var n=t.toArray(arguments),r=0;r<e.tests.length;++r)try{n=r?e.tests[r](n):e.tests[r].apply(e.tests[r],n)}catch(i){if(!e.if_error)throw i;e.if_error(i)}return n};e.tests=[],h.util.add.run(e),h.util.add.err(e),h.util.add.last(e),h.util.add.add(e);for(var n=0;n<arguments.length;++n)e.add(arguments[n]);return e}function c(){var t=function(e){function n(){i=!0}try{for(var r=0;r<t.tests.length;++r){var i=!1,o=t.tests[r](e,n);if(i)return o}}catch(s){if(t.if_error)return t.if_error(s);throw s}if(t.last_fn)return t.last_fn(e);throw"All tests failed"};t.tests=[],h.util.add.add(t),h.util.add.err(t),h.util.add.run(t),h.util.add.last(t);for(var e=0;e<arguments.length;++e)t.add(arguments[e]);return t}function l(){var t=function(e){var n,r=null;for(n=0;!r&&n<t.tests.length;++n)try{if(r=t.tests[n](e))return n}catch(i){if(!t.if_error)throw i;r=t.if_error.call(t,i,e)}if(!r)try{if(!t.if_last||!t.if_last(e))throw error=new Error("no handler for data"),error.data=e,error}catch(i){if("no handler for data"==i.message)throw i;if(!t.if_error)throw i;t.if_error(i)}return n};t.tests=[],h.util.add.add(t),h.util.add.err(t),h.util.add.run(t);for(var e=0;e<arguments.length;++e)t.add(arguments[e]);return t}function f(t,e,n,r){var i=function(){var t=Array.prototype.slice.call(arguments);try{return i.test.apply(i,t)?"function"==typeof i.if_true?i.if_true.apply(i,t):i.if_true:"function"==typeof i.if_false?i.if_false.apply(i,t):i.if_false}catch(e){if(i.if_error)return i.if_error.call(i,e);throw e}};return i.test=t,i.if_true=e,i.if_false=n,i.if_error=r,i.then=function(t){return i.if_true=t,i},i.else=function(t){return i.if_false=t,i},h.util.add.run(i),h.util.add.err(i),i}var h={util:{math:{sum:function(){var e=t.filter(t.toArray(arguments),_isNumber);return t.reduce(e,function(t,e){return t+e},0)}},add:{last:function(t){t.last=function(e){return t.last_fn=e,t}},run:function(t){t.run=function(e,n){var r=t(e);return n&&n(r),t}},err:function(t){t.err=function(e){return t.if_error=e,t}},add:function(t){return t.add=function(e){return t.tests||(t.tests=[]),t.tests.push(e),t},t}}}};return h.range=n,h.all=r,h.rate=i,h.loop=o,h.pairs=s,h.each=a,h.pipe=u,h.gauntlet=c,h.until=l,h.fork=f,h}),function(t,r){"object"==typeof exports?module.exports=r(e("lodash"),e("fools")):"function"==typeof n&&n.amd?n("n-space",["require","exports","module","lodash","fools"],function(t,e,n){n.exports=r(t("lodash"),t("fools"))}):t.NSPACE=r(t._,t.Fools)}(this,function(t,e){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,e){var n=this.listeners[t];if(n)for(var r=0;r<n.length;r++)n[r].call(this._owner,e);return this},n.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]);var n=this.listeners[t].indexOf(e);return 0>n&&this.listeners[t].push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.removeListener=function(t,e){var n=this.listeners[t].indexOf(e);return n>=0&&this.listeners[t].splice(n,1),this},n.prototype.bindThis=function(t){this._owner=t};var r={rid:0,mid:0,reset:function(){r.mid=0,r.rid=0}},i=0;r.Register=function(t,e){this.loc=e,this.world=t,this.content={},this.rid=++i},t.extend(r.Register.prototype,{t:"Register",equals:function(e){function n(t){return e[t.name]!==r.loc[t.name]}var r=this,i=t.find(this.world.dimArray,n);return!i},serialize:function(){var e=t.clone(this.loc);return e.content=t.clone(this.content),t.each(e.content,function(n,r){e.content[r]=t.reduce(n,function(e,n){return e.push(n.serialize&&t.isFunction(n.serialize)?n.serialize():n),e},[])}),e},get:function(t){return this.has(t)?this.content[t].slice(0):[]},getFirst:function(e){var n=this.get(e);return t.first(n)},has:function(t){return this.content.hasOwnProperty(t)&&this.content[t].length},add:function(t,e,n){e||(e="___content"),!n&&this.content[e]?this.content[e].push(t):this.content[e]=[t]},remove:function(e,n){this.content.hasOwnProperty(n)&&this.content[n]&&t.isArray(this.content[n])&&(this.content[n]=t.difference(this.content[n],[e]),this.content[n].length||delete this.content[n])},neighbors:function(){var e=t.toArray(arguments);return e.unshift(this.loc),this.world.neighbors.apply(this.world,e)}}),r.World=function(t){t?this.init(t):this.dims={}},t.extend(r.World.prototype,{serialize:function(){var e=t.flatten(this.cells);e=t.map(e,function(t){return t.serialize()});var n=this.dimNames();return n.unshift(e),t.sortBy.apply(t,n)},dimNames:function(){return t.pluck(this.dimArray,"name")},add:function(t,e,n){this.goodType(e,"add"),this.goodLoc(n,"add");var r=this.getRegistry(n);if(!r)throw"cannot get registry";r.add(t,e)},remove:function(e,n,r){if(this.goodType(n),r){this.goodLoc(r,"remove");var i=this.getRegistry(r);if(!i)throw"cannot get registry";i.remove(e,n)}else t.each(this.registries(),function(t){t.remove(e,n)})},goodType:function(e,n){if(!e||!t.isString(e)&&!t.isNumber(e))throw"World."+(n||"goodType")+": missing or non-string /number type"},goodLoc:function(e,n){if(!e||!t.isObject(e))throw"World."+(n||"goodLoc")+": missing or non-object location";for(var r in this.dims){if(!e.hasOwnProperty(r))throw"World."+(n||"goodLoc")+": loc missing parameter "+r;if(!t.isNumber(e[r]))throw"World."+(n||"goodLoc")+": non numeric "+r}},locInRange:function(e,n){if(n)try{this.goodLoc(e)}catch(r){return!1}return!t.find(e,function(t,e){var n=this.dims[e];return t<n[0]?!0:t>n[1]?!0:!1},this)},neighborsExcept:function(e){var n=t.toArray(arguments),r=this.neighbors.apply(this,n);return t.reject(r,function(t){return t.equals(e)?!0:!1})},neighbors:function(n){this.goodLoc(n,"neighbors");var r;r=arguments.length>1?t.isArray(arguments[1])?arguments[1]:t.toArray(arguments).slice(1):t.pluck(this.dimArray,"name");var i=[],o=e.loop(function(e){var r=t.defaults({},e,n);this.locInRange(r)&&i.push(this.getRegistry(r))}.bind(this));return t.each(r,function(t){if(!this.dims.hasOwnProperty(t))throw"neighbors:bad dim "+t;var e=(this.dims[t],n[t]-1),r=n[t]+1;o.dim(t,e,r)},this),o(),i},registries:function(){return this._registries||(this._registries=t.flatten(this.cells)),this._registries},getRegistry:function(e){this.locInRange(e,!0);var n=this,r=t.pluck(this.dimArray,"name"),i=t.reduce(r,function(t,r){if(!t)throw"no cells for "+r;if(!e.hasOwnProperty(r))throw"World.getRegistry:loc missing property "+r;var i=e[r];if(!n.dims.hasOwnProperty(r))throw"World.getRegistry:non-dimension "+r;var o=n.dims[r];i-=o[0];try{if(i>=0&&i<=t.length&&t[i])return t[i];throw"out of bound index for "+r+": "+i}catch(s){throw console.log("retrieval error: ",s),s}},this.cells);if("Register"!==i.t)throw"World.getRegistry:bad request";return i},goodDims:function(){var e=0;for(var n in this.dims){++e;var r=this.dims[n];if(r.length<2)throw"missing range data for "+n;var i=r[0];if(!t.isNumber(i))throw"non numeric min for "+n;if(i!==Math.floor(i))throw"fractional min for "+n;var o=r[1];if(!t.isNumber(o))throw"non numeric max for "+n;if(o!==Math.floor(o))throw"fractional max for "+n;if(i>o)throw"Bad range for "+n}if(0===e)throw"must have at least one dim"},ifRange:function(n,r,i){var o=e.each();t.each(n,function(e,n){if(t.isNumber(e))o.add(function(t){return t.loc[n]===e});else if(t.isArray(e))o.add(function(t){return t.loc[n]>=e[0]&&t.loc[n]<=e[1]});else if(t.isFunction(e))return e(reg.loc[n])});var s=e.fork(o).then(r).else(i).err(function(t){console.log("err: ",t)});t.each(this.registries(),s)},init:function(e){function n(e,o,s){if(e){var a=e.name,u=e.min,c=e.max;return u=Math.floor(u),t.map(t.range(u,c+1),function(e){var u={};return u[a]=e,t.extend(u,s),o.length?n(null,o,u):new r.Register(i,u)})}return o.length?n(o[0],o.slice(1),s):void 0}e&&(this.dims=e),this.goodDims(),this._registries=!1,this.dimArray=t.map(this.dims,function(t,e){return{name:e,min:t[0],max:t[1]}});var i=this;this.cells=n(null,this.dimArray)}});var o=0;return r.Member=function(t,e,r,i){this.mid=++o,this.world=e,this.loc=r||null,this.mType=t||"__member",this.stackLimit=i?i:1,n.call(this)},t.extend(r.Member.prototype,{serialize:function(){return{mid:this.mid,loc:t.clone(this.loc)}},neighbors:function(){return this.world.neighbors(this.loc)},neighborsExcept:function(){return this.world.neighborsExcept(this.loc)},addToWorld:function(t,e){return e&&(this.world=e),this.canStack(t||this.loc)?(this.loc&&this.world.remove(this,this.mType,this.loc),t&&(this.loc=t),this.world.add(this,this.mType,this.loc),this.emit("at",this,this.loc),!0):!1},canStack:function(e){if(this.stackLimit<=0)return!0;var n=this.world.getRegistry(e);if(!n.has(this.mType))return!0;var r=t.reduce(n.get(this.mType),function(t,e){return e?e.mid===this.mid?t:t+1:t},0,this);return r<this.stackLimit},remove:function(t){this.loc&&this.emit("leaving",this,this.loc),this.world.remove(this,this.mType,t?null:this.loc),this.emit("removed",this)},move:function(t){this.remove(),this.addToWorld(t)},moveAni:function(e,n,r){this._moving&&(this.emit("move stop",this,this.to_stub.loc),this.endMoveAni(this.moveAniTime()/this.move_msec>.5,!0)),this.move_msec=Math.max(10,n),this.from_stub={loc:t.clone(this.loc),member:this},this.to_stub={loc:t.clone(e),member:this},this.remove(),this.world.add(this.from_stub,this.mType,this.loc),this.world.add(this.to_stub,this.mType,e),r||(r=Math.max(10,Math.min(100,Math.round(this.move_msec/4)))),this._moving=setInterval(this.slide.bind(this),r),this.move_time=(new Date).getTime()},moveAniTime:function(){var t=(new Date).getTime();return t-this.move_time},slide:function(){var t=this.moveAniTime();t>this.move_msec?this.endMoveAni(!0):(this.from_stub.progress=this.to_stub.progress=this.progress=t/this.move_msec,this.emit("slide progress",this,this.slideLoc()))},slideLoc:function(){var e=t.clone(this.from_stub.loc),n=t.clone(this.to_stub.loc),r=this.progress,i=1-r;return t.each(e,function(t,o){e[o]=t*i,n[o]*=r,n[o]+=e[o]}),n},endMoveAni:function(t,e){this.world.remove(this.from_stub,this.mType),this.world.remove(this.to_stub,this.mType),clearInterval(this._moving),this._moving=null,this.move(t?this.to_stub.loc:this.from_stub.loc),delete this.to_stub,delete this.from_stub,delete this.progress,e||this.emit("move end",this,this.loc)}}),t.extend(r.Member.prototype,n.prototype),r.WanderBotScanRule=function(t,e,n){this.bot=t,this.world=t.world,this.dims=e,this.reductor=n},r.WanderBotScanRule.checkStack=function(t,e){return function(n,r){return t.member.canStack(r.loc)?e?e(n,r):r:n}},r.WanderBotScanRule.forwardBackward=function(t){return function(e,n){return e&&n.loc[t]<e.loc[t]?e:n}},r.WanderBotScanRule.forward=function(t,e){return function(n,r){var i=e.loc()[t];return r.loc[t]<=i?n:r}},r.WanderBotScanRule.backwardForward=function(t){return function(e,n){return e&&n.loc[t]>e.loc[t]?e:n}},r.WanderBotScanRule.backward=function(t,e){return function(n,r){var i=e.loc()[t];return r.loc[t]>=i?n:r}},t.extend(r.WanderBotScanRule.prototype,{scan:function(e){var n=this.dimNeighbors(e);return t.reduce(n,this.reductor,null)},loc:function(){return this.bot.loc()},dimNeighbors:function(e){var n=this;if(this.dims&&this.dims.length){var r=t.difference(this.world.dimNames(),this.dims);return t.reduce(e,function(e,i){var o=t.find(r,function(t){var e=n.loc()[t],r=i.loc[t];return e!==r?t:!1});return o||e.push(i),e},[])}return e},test:function(){var t=this;return function(e,n){var r=t.scan(e);return r&&n(),r}}}),r.WanderBot=function(t,e,n,i){this.member=new r.Member(t,e,n,i),this.world=e,this.scanRules=[]},t.extend(r.WanderBot.prototype,{loc:function(){return this.member.loc},serialize:function(){return t.extend({wanderBot:!0},this.member.serialize())},addScanRule:function(t,e){var n=new r.WanderBotScanRule(this,t,e);return this.scanRules.push(n),n},scan:function(){var n=e.gauntlet();n.if_last=function(){return!1},t.each(this.scanRules,function(t){n.add(t.test())});var r=this.member.neighborsExcept(),i=n(r);return i},moveTo:function(t){this.member.move(t)},move:function(){var t=!1;try{t=this.scan()}catch(e){}t&&this.member.move(t.loc)},moveAni:function(t){var e=this.scan();e&&this.member.moveAni(e.loc,t)}}),r}),n("famous/modifiers/StateModifier",["require","exports","module","famous/core/Modifier","famous/core/Transform","famous/transitions/Transitionable","famous/transitions/TransitionableTransform"],function(t,e,n){function r(t){this._transformState=new a(o.identity),this._opacityState=new s(1),this._originState=new s([0,0]),this._sizeState=new s([0,0]),this._modifier=new i({transform:this._transformState,opacity:this._opacityState,origin:null,size:null}),this._hasOrigin=!1,this._hasSize=!1,t&&(t.transform&&this.setTransform(t.transform),void 0!==t.opacity&&this.setOpacity(t.opacity),t.origin&&this.setOrigin(t.origin),t.size&&this.setSize(t.size))}var i=t("famous/core/Modifier"),o=t("famous/core/Transform"),s=t("famous/transitions/Transitionable"),a=t("famous/transitions/TransitionableTransform");r.prototype.setTransform=function(t,e,n){return this._transformState.set(t,e,n),this},r.prototype.setOpacity=function(t,e,n){return this._opacityState.set(t,e,n),this},r.prototype.setOrigin=function(t,e,n){return null===t?(this._hasOrigin&&(this._modifier.originFrom(null),this._hasOrigin=!1),this):(this._hasOrigin||(this._hasOrigin=!0,this._modifier.originFrom(this._originState)),this._originState.set(t,e,n),this)},r.prototype.setSize=function(t,e,n){return null===t?(this._hasSize&&(this._modifier.sizeFrom(null),this._hasSize=!1),this):(this._hasSize||(this._hasSize=!0,this._modifier.sizeFrom(this._sizeState)),this._sizeState.set(t,e,n),this)},r.prototype.halt=function(){this._transformState.halt(),this._opacityState.halt(),this._originState.halt(),this._sizeState.halt()},r.prototype.getTransform=function(){return this._transformState.get()},r.prototype.getFinalTransform=function(){return this._transformState.getFinal()},r.prototype.getOpacity=function(){return this._opacityState.get()},r.prototype.getOrigin=function(){return this._hasOrigin?this._originState.get():null},r.prototype.getSize=function(){return this._hasSize?this._sizeState.get():null},r.prototype.modify=function(t){return this._modifier.modify(t)},n.exports=r}),n("famous/core/View",["require","exports","module","./EventHandler","./OptionsManager","./RenderNode"],function(t,e,n){function r(t){this._node=new s,this._eventInput=new i,this._eventOutput=new i,i.setInputHandler(this,this._eventInput),i.setOutputHandler(this,this._eventOutput),this.options=Object.create(this.constructor.DEFAULT_OPTIONS||r.DEFAULT_OPTIONS),this._optionsManager=new o(this.options),t&&this.setOptions(t)}var i=t("./EventHandler"),o=t("./OptionsManager"),s=t("./RenderNode");r.DEFAULT_OPTIONS={},r.prototype.getOptions=function(){return this._optionsManager.value()},r.prototype.setOptions=function(t){this._optionsManager.patch(t)},r.prototype.add=function(){return this._node.add.apply(this._node,arguments)},r.prototype._add=r.prototype.add,r.prototype.render=function(){return this._node.render()},r.prototype.getSize=function(){return this._node&&this._node.getSize?this._node.getSize.apply(this._node,arguments)||this.options.size:this.options.size},n.exports=r}),n("Grass",["require","exports","module","famous/core/Engine","famous/modifiers/StateModifier","famous/core/Transform","famous/core/Surface","famous/core/View","./n-space","./lodash","./fools"],function(t,e,n){function r(t,e,n,o){this.world=t,a.call(this,u.defaults({i:e,j:n,id:++c},o,r.DEFAULTS)),this.mod=new i({origin:[.5,0],size:[this.options.width,this.options.height],transform:this._transform()}),this._node.add(this.mod).add(this.surface()),t.add(this,"grass",{i:e,j:n}),this.update()}var i=(t("famous/core/Engine"),t("famous/modifiers/StateModifier")),o=t("famous/core/Transform"),s=t("famous/core/Surface"),a=t("famous/core/View"),u=(t("./n-space"),t("./lodash")),c=(t("./fools"),0);r.DEFAULTS={width:400,height:400,scale:.5,i:0,j:0,k:0,GRID_SIZE:100},r.prototype=Object.create(a.prototype),u.extend(r.prototype,{_transform:function(){var t=this.options.GRID_SIZE,e=[this.options.i*t,this.options.j*t,0],n=o.thenMove(o.rotateX(Math.PI/2),e);return o.multiply(n,o.scale(this.options.scale,this.options.scale,this.options.scale))},eat:function(){this.mod.halt(),--this.options.k,this.update()},surface:function(){return this._surface||(this._surface=new s({classes:["grass"]})),this._surface},update:function(){var t=Math.min(5,1-this.options.k);this.surface().setClasses(["grass","grass-"+t])}}),n.exports=r}),n("goat",["require","exports","module","famous/core/Engine","famous/modifiers/StateModifier","famous/core/Transform","famous/core/Surface","famous/core/View","./n-space","./lodash","./fools","./Grass"],function(t,e,n){function r(t,e,n,o){a.call(this,c.defaults({i:e,j:n,id:++f},o,r.DEFAULTS)),this.world=t,this.bot=new u.WanderBot("goat",t,{i:e,j:n},1),this.mod=new i({origin:[.5,0],transform:this._transform()}),this._node.add(this.mod).add(this.surface());var s=this.bot.addScanRule(["i","j"],c.identity);s.scan=function(t){return t[Math.floor(Math.random()*t.length)]},this.behavior=l.gauntlet().add(function(t,e){var n=l.fork(function(t){return t.hunger()>t.options.maxHunger}).then(function(t){return t.die(),e(),t}).else(function(t){return t});l.fork(function(t){return!t.options.alive}).then(function(){return e(),t}).else(n)(t)}).add(function(t,e){return t.options.fainted>0&&(--t.options.fainted,e()),t}).add(function(t,e){return Math.random()>.95&&(t.options.fainted=10*Math.random(),t.mod.setTransform(t._transform(),{duration:300}),e()),t}).add(function(t,e){var n=l.fork(function(t){return t._is_eating}).then(function(t){return e(),t.eat(),t}).else(function(){}).err(function(t){console.log("goat err: ",t)}),r=l.fork(function(t){return t.canEat()}).then(function(t){t.eat(),e()}).else(function(t){t.stopEating()});l.fork(function(t){return t.hunger()>3}).then(r).else(n).err(function(t){console.log("goat err 2 ",t)})(t)}).add(function(t,e){t._is_eating||t.walk(),e()})}var i=(t("famous/core/Engine"),t("famous/modifiers/StateModifier")),o=t("famous/core/Transform"),s=t("famous/core/Surface"),a=t("famous/core/View"),u=t("./n-space"),c=t("./lodash"),l=t("./fools"),f=(t("./Grass"),0);r.DEFAULTS={type:"goat",hunger:0,fatigue:0,size:100,moves:0,transSpeed:200,fainted:0,maxHunger:20,alive:!0},r.prototype=Object.create(a.prototype);c.template("rgb(<%= red %>,<%= green %>,<%= blue %>)");c.extend(r.prototype,{update:function(){this.hunger()>5&&console.log("goat hunger: ",this.hunger()),this.behavior(this)},hunger:function(){return this.options.hunger},canEat:function(){var t=this.getGrass();return t?t.options.k>-5:!1},eat:function(){this._is_eating=!0,--this.options.hunger,this.surface().setClasses(["goat","eating"]),this.hunger()<=0&&this.stopEating();var t=this.getGrass();t&&t.eat()},die:function(){console.log("DEAD GOAT"),this.options.alive=!1,this.mod.halt(),this.mod.setTransform(this._transform()),this.surface().setClasses(["goat","dead"])
},getGrass:function(){var t=this.bot.member.loc.i,e=this.bot.member.loc.j;return this.world.getRegistry({i:t,j:e}).getFirst("grass")},stopEating:function(){this.surface().setClasses(["goat"]),this._is_eating=0},walk:function(){this.bot.move(),this.surface().setClasses(["goat"]),this.mod.setTransform(this._transform(),{duration:this.options.transSpeed},function(){}.bind(this)),++this.options.hunger},_transform:function(){var t,e=this.options.GRID_SIZE,n=[this.bot.member.loc.i*e,this.bot.member.loc.j*e,0];return t=o.thenMove(o.rotateX(this.options.fainted>0?0:Math.PI/2),n)},surface:function(){return this._surface||(this._surface=new s({size:[this.options.size,3*this.options.size/4],classes:["goat"],transform:o.scale(.5,.5,.5)})),this._surface}}),n.exports=r}),n("grass",["require","exports","module","famous/core/Engine","famous/modifiers/StateModifier","famous/core/Transform","famous/core/Surface","famous/core/View","./n-space","./lodash","./fools"],function(t,e,n){function r(t,e,n,o){this.world=t,a.call(this,u.defaults({i:e,j:n,id:++c},o,r.DEFAULTS)),this.mod=new i({origin:[.5,0],size:[this.options.width,this.options.height],transform:this._transform()}),this._node.add(this.mod).add(this.surface()),t.add(this,"grass",{i:e,j:n}),this.update()}var i=(t("famous/core/Engine"),t("famous/modifiers/StateModifier")),o=t("famous/core/Transform"),s=t("famous/core/Surface"),a=t("famous/core/View"),u=(t("./n-space"),t("./lodash")),c=(t("./fools"),0);r.DEFAULTS={width:400,height:400,scale:.5,i:0,j:0,k:0,GRID_SIZE:100},r.prototype=Object.create(a.prototype),u.extend(r.prototype,{_transform:function(){var t=this.options.GRID_SIZE,e=[this.options.i*t,this.options.j*t,0],n=o.thenMove(o.rotateX(Math.PI/2),e);return o.multiply(n,o.scale(this.options.scale,this.options.scale,this.options.scale))},eat:function(){this.mod.halt(),--this.options.k,this.update()},surface:function(){return this._surface||(this._surface=new s({classes:["grass"]})),this._surface},update:function(){var t=Math.min(5,1-this.options.k);this.surface().setClasses(["grass","grass-"+t])}}),n.exports=r}),n("main",["require","exports","module","famous/core/Engine","famous/core/Modifier","famous/core/Transform","famous/surfaces/ImageSurface","./n-space","./goat","./grass"],function(t){function e(){_.each(f,function(t){t.update()}),setTimeout(function(){requestAnimationFrame(e)},h)}var n=t("famous/core/Engine"),r=t("famous/core/Modifier"),i=t("famous/core/Transform"),o=(t("famous/surfaces/ImageSurface"),t("./n-space")),s=t("./goat"),a=t("./grass"),u=n.createContext();u.setPerspective(1e3);var c=new o.World({i:[-8,8],j:[-5,20]}),l=u.add(new r({origin:[.5,.5],transform:i.multiply(i.moveThen([0,400,1e3],i.rotateX(-Math.PI/2)),i.identity)})),f=_.map(_.range(0,40),function(t){var e=new s(c,t%5,Math.floor(t/5),{GRID_SIZE:80});return l.add(e),e});_.each(c.registries(),function(t){l.add(new a(c,t.loc.i,t.loc.j))});var h=500;e()}),e(["main"])}();